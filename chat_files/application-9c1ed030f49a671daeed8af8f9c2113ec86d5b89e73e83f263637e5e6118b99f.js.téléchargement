function FastClick(t){"use strict";var e,i=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=t,!t||!t.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(i,arguments)},this.onMouse=function(){return FastClick.prototype.onMouse.apply(i,arguments)},this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(i,arguments)},this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(i,arguments)},this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(i,arguments)},this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(i,arguments)},FastClick.notNeeded(t)||(this.deviceIsAndroid&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,i,n){var s=Node.prototype.removeEventListener;"click"===e?s.call(t,e,i.hijacked||i,n):s.call(t,e,i,n)},t.addEventListener=function(e,i,n){var s=Node.prototype.addEventListener;"click"===e?s.call(t,e,i.hijacked||(i.hijacked=function(t){t.propagationStopped||i(t)}),n):s.call(t,e,i,n)}),"function"==typeof t.onclick&&(e=t.onclick,t.addEventListener("click",function(t){e(t)},!1),t.onclick=null))}!function(t,e){"use strict";t.rails!==e&&t.error("jquery-ujs has already been loaded!");var i,n=t(document);t.rails=i={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not([form]):not(form button), button[data-confirm]:not([form]):not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]), textarea[name][required]:not([disabled])",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",csrfToken:function(){return t("meta[name=csrf-token]").attr("content")},csrfParam:function(){return t("meta[name=csrf-param]").attr("content")},CSRFProtection:function(t){var e=i.csrfToken();e&&t.setRequestHeader("X-CSRF-Token",e)},refreshCSRFTokens:function(){t('form input[name="'+i.csrfParam()+'"]').val(i.csrfToken())},fire:function(e,i,n){var s=t.Event(i);return e.trigger(s,n),!1!==s.result},confirm:function(t){return confirm(t)},ajax:function(e){return t.ajax(e)},href:function(t){return t[0].href},isRemote:function(t){return t.data("remote")!==e&&!1!==t.data("remote")},handleRemote:function(n){var s,r,o,a,l,c;if(i.fire(n,"ajax:before")){if(a=n.data("with-credentials")||null,l=n.data("type")||t.ajaxSettings&&t.ajaxSettings.dataType,n.is("form")){s=n.data("ujs:submit-button-formmethod")||n.attr("method"),r=n.data("ujs:submit-button-formaction")||n.attr("action"),o=t(n[0]).serializeArray();var h=n.data("ujs:submit-button");h&&(o.push(h),n.data("ujs:submit-button",null)),n.data("ujs:submit-button-formmethod",null),n.data("ujs:submit-button-formaction",null)}else n.is(i.inputChangeSelector)?(s=n.data("method"),r=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):n.is(i.buttonClickSelector)?(s=n.data("method")||"get",r=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):(s=n.data("method"),r=i.href(n),o=n.data("params")||null);return c={type:s||"GET",data:o,dataType:l,beforeSend:function(t,s){if(s.dataType===e&&t.setRequestHeader("accept","*/*;q=0.5, "+s.accepts.script),!i.fire(n,"ajax:beforeSend",[t,s]))return!1;n.trigger("ajax:send",t)},success:function(t,e,i){n.trigger("ajax:success",[t,e,i])},complete:function(t,e){n.trigger("ajax:complete",[t,e])},error:function(t,e,i){n.trigger("ajax:error",[t,e,i])},crossDomain:i.isCrossDomain(r)},a&&(c.xhrFields={withCredentials:a}),r&&(c.url=r),i.ajax(c)}return!1},isCrossDomain:function(t){var e=document.createElement("a");e.href=location.href;var i=document.createElement("a");try{return i.href=t,i.href=i.href,!((!i.protocol||":"===i.protocol)&&!i.host||e.protocol+"//"+e.host==i.protocol+"//"+i.host)}catch(t){return!0}},handleMethod:function(n){var s=i.href(n),r=n.data("method"),o=n.attr("target"),a=i.csrfToken(),l=i.csrfParam(),c=t('<form method="post" action="'+s+'"></form>'),h='<input name="_method" value="'+r+'" type="hidden" />';l===e||a===e||i.isCrossDomain(s)||(h+='<input name="'+l+'" value="'+a+'" type="hidden" />'),o&&c.attr("target",o),c.hide().append(h).appendTo("body"),c.submit()},formElements:function(e,i){return e.is("form")?t(e[0].elements).filter(i):e.find(i)},disableFormElements:function(e){i.formElements(e,i.disableSelector).each(function(){i.disableFormElement(t(this))})},disableFormElement:function(t){var i,n;i=t.is("button")?"html":"val",n=t.data("disable-with"),n!==e&&(t.data("ujs:enable-with",t[i]()),t[i](n)),t.prop("disabled",!0),t.data("ujs:disabled",!0)},enableFormElements:function(e){i.formElements(e,i.enableSelector).each(function(){i.enableFormElement(t(this))})},enableFormElement:function(t){var i=t.is("button")?"html":"val";t.data("ujs:enable-with")!==e&&(t[i](t.data("ujs:enable-with")),t.removeData("ujs:enable-with")),t.prop("disabled",!1),t.removeData("ujs:disabled")},allowAction:function(t){var e,n=t.data("confirm"),s=!1;if(!n)return!0;if(i.fire(t,"confirm")){try{s=i.confirm(n)}catch(t){(console.error||console.log).call(console,t.stack||t)}e=i.fire(t,"confirm:complete",[s])}return s&&e},blankInputs:function(e,i,n){var s,r,o,a,l=t(),c=i||"input,textarea",h=e.find(c),u={};return h.each(function(){s=t(this),s.is("input[type=radio]")?(a=s.attr("name"),u[a]||(0===e.find('input[type=radio]:checked[name="'+a+'"]').length&&(o=e.find('input[type=radio][name="'+a+'"]'),l=l.add(o)),u[a]=a)):(r=s.is("input[type=checkbox],input[type=radio]")?s.is(":checked"):!!s.val())===n&&(l=l.add(s))}),!!l.length&&l},nonBlankInputs:function(t,e){return i.blankInputs(t,e,!0)},stopEverything:function(e){return t(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},disableElement:function(t){var n=t.data("disable-with");n!==e&&(t.data("ujs:enable-with",t.html()),t.html(n)),t.bind("click.railsDisable",function(t){return i.stopEverything(t)}),t.data("ujs:disabled",!0)},enableElement:function(t){t.data("ujs:enable-with")!==e&&(t.html(t.data("ujs:enable-with")),t.removeData("ujs:enable-with")),t.unbind("click.railsDisable"),t.removeData("ujs:disabled")}},i.fire(n,"rails:attachBindings")&&(t.ajaxPrefilter(function(t,e,n){t.crossDomain||i.CSRFProtection(n)}),t(window).on("pageshow.rails",function(){t(t.rails.enableSelector).each(function(){var e=t(this);e.data("ujs:disabled")&&t.rails.enableFormElement(e)}),t(t.rails.linkDisableSelector).each(function(){var e=t(this);e.data("ujs:disabled")&&t.rails.enableElement(e)})}),n.on("ajax:complete",i.linkDisableSelector,function(){i.enableElement(t(this))}),n.on("ajax:complete",i.buttonDisableSelector,function(){i.enableFormElement(t(this))}),n.on("click.rails",i.linkClickSelector,function(e){var n=t(this),s=n.data("method"),r=n.data("params"),o=e.metaKey||e.ctrlKey;if(!i.allowAction(n))return i.stopEverything(e);if(!o&&n.is(i.linkDisableSelector)&&i.disableElement(n),i.isRemote(n)){if(o&&(!s||"GET"===s)&&!r)return!0;var a=i.handleRemote(n);return!1===a?i.enableElement(n):a.fail(function(){i.enableElement(n)}),!1}return s?(i.handleMethod(n),!1):void 0}),n.on("click.rails",i.buttonClickSelector,function(e){var n=t(this);if(!i.allowAction(n)||!i.isRemote(n))return i.stopEverything(e);n.is(i.buttonDisableSelector)&&i.disableFormElement(n);var s=i.handleRemote(n);return!1===s?i.enableFormElement(n):s.fail(function(){i.enableFormElement(n)}),!1}),n.on("change.rails",i.inputChangeSelector,function(e){var n=t(this);return i.allowAction(n)&&i.isRemote(n)?(i.handleRemote(n),!1):i.stopEverything(e)}),n.on("submit.rails",i.formSubmitSelector,function(n){var s,r,o=t(this),a=i.isRemote(o);if(!i.allowAction(o))return i.stopEverything(n);if(o.attr("novalidate")===e)if(o.data("ujs:formnovalidate-button")===e){if((s=i.blankInputs(o,i.requiredInputSelector,!1))&&i.fire(o,"ajax:aborted:required",[s]))return i.stopEverything(n)}else o.data("ujs:formnovalidate-button",e);if(a){if(r=i.nonBlankInputs(o,i.fileInputSelector)){setTimeout(function(){i.disableFormElements(o)},13);var l=i.fire(o,"ajax:aborted:file",[r]);return l||setTimeout(function(){i.enableFormElements(o)},13),l}return i.handleRemote(o),!1}setTimeout(function(){i.disableFormElements(o)},13)}),n.on("click.rails",i.formInputClickSelector,function(e){var n=t(this);if(!i.allowAction(n))return i.stopEverything(e);var s=n.attr("name"),r=s?{name:s,value:n.val()}:null,o=n.closest("form");0===o.length&&(o=t("#"+n.attr("form"))),o.data("ujs:submit-button",r),o.data("ujs:formnovalidate-button",n.attr("formnovalidate")),o.data("ujs:submit-button-formaction",n.attr("formaction")),o.data("ujs:submit-button-formmethod",n.attr("formmethod"))}),n.on("ajax:send.rails",i.formSubmitSelector,function(e){this===e.target&&i.disableFormElements(t(this))}),n.on("ajax:complete.rails",i.formSubmitSelector,function(e){this===e.target&&i.enableFormElements(t(this))}),t(function(){i.refreshCSRFTokens()}))}(jQuery);var Faye=function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n=i(1),s=i(2),r={VERSION:n.VERSION,Client:i(4),Scheduler:i(32)};s.wrapper=r,t.exports=r},function(t){t.exports={VERSION:"1.2.4",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"]}},function(t,e,i){"use strict";var n=i(3),s={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(t,e){var i=s.logger||(s.wrapper||s).logger;if(i){var r=Array.prototype.slice.apply(t),o="[Faye",a=this.className,l=r.shift().replace(/\?/g,function(){try{return n(r.shift())}catch(t){return"[Object]"}});a&&(o+="."+a),o+="] ","function"==typeof i[e]?i[e](o+l):"function"==typeof i&&i(o+l)}}};for(var r in s.LOG_LEVELS)!function(t){s[t]=function(){this.writeLog(arguments,t)}}(r);t.exports=s},function(t){"use strict";t.exports=function(t){return JSON.stringify(t,function(t,e){return this[t]instanceof Array?this[t]:e})}},function(t,e,i){(function(e){"use strict";var n=i(5),s=i(7),r=(i(9),i(10)),o=i(11),a=i(12),l=i(1),c=i(8),h=i(13),u=i(14),d=i(2),p=i(15),f=i(17),m=i(19),g=i(33),v=i(34),_=i(35),b=i(36),y=s({className:"Client",UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(t,i){this.info("New client created for ?",t),i=i||{},h(i,["interval","timeout","endpoints","proxy","retry","scheduler","websocketExtensions","tls","ca"]),this._channels=new f.Set,this._dispatcher=m.create(this,t||this.DEFAULT_ENDPOINT,i),this._messageId=0,this._state=this.UNCONNECTED,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(i.interval||this.INTERVAL),timeout:1e3*(i.timeout||this.CONNECTION_TIMEOUT)},this._dispatcher.timeout=this._advice.timeout/1e3,this._dispatcher.bind("message",this._receiveMessage,this),a.Event&&void 0!==e.onbeforeunload&&a.Event.on(e,"beforeunload",function(){o.indexOf(this._dispatcher._disabled,"autodisconnect")<0&&this.disconnect()},this)},addWebsocketExtension:function(t){return this._dispatcher.addWebsocketExtension(t)},disable:function(t){return this._dispatcher.disable(t)},setHeader:function(t,e){return this._dispatcher.setHeader(t,e)},handshake:function(t,i){if(this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED){this._state=this.CONNECTING;var s=this;this.info("Initiating handshake with ?",r.stringify(this._dispatcher.endpoint)),this._dispatcher.selectTransport(l.MANDATORY_CONNECTION_TYPES),this._sendMessage({channel:f.HANDSHAKE,version:l.BAYEUX_VERSION,supportedConnectionTypes:this._dispatcher.getConnectionTypes()},{},function(r){r.successful?(this._state=this.CONNECTED,this._dispatcher.clientId=r.clientId,this._dispatcher.selectTransport(r.supportedConnectionTypes),this.info("Handshake successful: ?",this._dispatcher.clientId),this.subscribe(this._channels.getKeys(),!0),t&&n(function(){t.call(i)})):(this.info("Handshake unsuccessful"),e.setTimeout(function(){s.handshake(t,i)},1e3*this._dispatcher.retry),this._state=this.UNCONNECTED)},this)}},connect:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake(function(){this.connect(t,e)},this);this.callback(t,e),this._state===this.CONNECTED&&(this.info("Calling deferred actions for ?",this._dispatcher.clientId),this.setDeferredStatus("succeeded"),this.setDeferredStatus("unknown"),this._connectRequest||(this._connectRequest=!0,this.info("Initiating connection for ?",this._dispatcher.clientId),this._sendMessage({channel:f.CONNECT,clientId:this._dispatcher.clientId,connectionType:this._dispatcher.connectionType},{},this._cycleConnection,this)))}},disconnect:function(){if(this._state===this.CONNECTED){this._state=this.DISCONNECTED,this.info("Disconnecting ?",this._dispatcher.clientId);var t=new _;return this._sendMessage({channel:f.DISCONNECT,clientId:this._dispatcher.clientId},{},function(e){e.successful?(this._dispatcher.close(),t.setDeferredStatus("succeeded")):t.setDeferredStatus("failed",g.parse(e.error))},this),this.info("Clearing channel listeners for ?",this._dispatcher.clientId),this._channels=new f.Set,t}},subscribe:function(t,e,i){if(t instanceof Array)return o.map(t,function(t){return this.subscribe(t,e,i)},this);var n=new b(this,t,e,i),s=!0===e;return this._channels.hasSubscription(t)&&!s?(this._channels.subscribe([t],n),n.setDeferredStatus("succeeded"),n):(this.connect(function(){this.info("Client ? attempting to subscribe to ?",this._dispatcher.clientId,t),s||this._channels.subscribe([t],n),this._sendMessage({channel:f.SUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},function(e){if(!e.successful)return n.setDeferredStatus("failed",g.parse(e.error)),this._channels.unsubscribe(t,n);var i=[].concat(e.subscription);this.info("Subscription acknowledged for ? to ?",this._dispatcher.clientId,i),n.setDeferredStatus("succeeded")},this)},this),n)},unsubscribe:function(t,e){if(t instanceof Array)return o.map(t,function(t){return this.unsubscribe(t,e)},this);this._channels.unsubscribe(t,e)&&this.connect(function(){this.info("Client ? attempting to unsubscribe from ?",this._dispatcher.clientId,t),this._sendMessage({channel:f.UNSUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},function(t){if(t.successful){var e=[].concat(t.subscription);this.info("Unsubscription acknowledged for ? from ?",this._dispatcher.clientId,e)}},this)},this)},publish:function(t,e,i){h(i||{},["attempts","deadline"]);var n=new _;return this.connect(function(){this.info("Client ? queueing published message to ?: ?",this._dispatcher.clientId,t,e),this._sendMessage({channel:t,data:e,clientId:this._dispatcher.clientId},i,function(t){t.successful?n.setDeferredStatus("succeeded"):n.setDeferredStatus("failed",g.parse(t.error))},this)},this),n},_sendMessage:function(t,e,i,n){t.id=this._generateMessageId();var s=this._advice.timeout?1.2*this._advice.timeout/1e3:1.2*this._dispatcher.retry;this.pipeThroughExtensions("outgoing",t,null,function(t){t&&(i&&(this._responseCallbacks[t.id]=[i,n]),this._dispatcher.sendMessage(t,s,e||{}))},this)},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_receiveMessage:function(t){var e,i=t.id;void 0!==t.successful&&(e=this._responseCallbacks[i],delete this._responseCallbacks[i]),this.pipeThroughExtensions("incoming",t,null,function(t){t&&(t.advice&&this._handleAdvice(t.advice),this._deliverMessage(t),e&&e[0].call(e[1],t))},this)},_handleAdvice:function(t){c(this._advice,t),this._dispatcher.timeout=this._advice.timeout/1e3,this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._dispatcher.clientId=null,this._cycleConnection())},_deliverMessage:function(t){t.channel&&void 0!==t.data&&(this.info("Client ? calling listeners for ? with ?",this._dispatcher.clientId,t.channel,t.data),this._channels.distributeMessage(t))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info("Closed connection for ?",this._dispatcher.clientId));var t=this;e.setTimeout(function(){t.connect()},this._advice.interval)}});c(y.prototype,u),c(y.prototype,p),c(y.prototype,d),c(y.prototype,v),t.exports=y}).call(e,function(){return this}())},function(t,e,i){"use strict";function n(){if(l.length)throw l.shift()}function s(t){var e;e=a.length?a.pop():new r,e.task=t,o(e)}function r(){this.task=null}var o=i(6),a=[],l=[],c=o.makeRequestCallFromTimer(n);t.exports=s,r.prototype.call=function(){try{this.task.call()}catch(t){s.onerror?s.onerror(t):(l.push(t),c())}finally{this.task=null,a[a.length]=this}}},function(t,e){(function(e){"use strict";function i(t){a.length||(o(),l=!0),a[a.length]=t}function n(){for(;c<a.length;){var t=c;if(c+=1,a[t].call(),c>h){for(var e=0,i=a.length-c;i>e;e++)a[e]=a[e+c];a.length-=c,c=0}}a.length=0,c=0,l=!1}function s(t){var e=1,i=new d(t),n=document.createTextNode("");return i.observe(n,{characterData:!0}),function(){e=-e,n.data=e}}function r(t){return function(){function e(){clearTimeout(i),clearInterval(n),t()}var i=setTimeout(e,0),n=setInterval(e,50)}}t.exports=i;var o,a=[],l=!1,c=0,h=1024,u=void 0!==e?e:self,d=u.MutationObserver||u.WebKitMutationObserver;o="function"==typeof d?s(n):r(n),i.requestFlush=o,i.makeRequestCallFromTimer=r}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(8);t.exports=function(t,e){"function"!=typeof t&&(e=t,t=Object);var i=function(){return this.initialize?this.initialize.apply(this,arguments)||this:this},s=function(){};return s.prototype=t.prototype,i.prototype=new s,n(i.prototype,e),i}},function(t){"use strict";t.exports=function(t,e,i){if(!e)return t;for(var n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)&&!1===i||t[n]!==e[n]&&(t[n]=e[n]));return t}},function(t,e,i){"use strict";var n=i(5),s=0,r=1,o=2,a=function(t){return t},l=function(t){throw t},c=function(t){if(this._state=s,this._onFulfilled=[],this._onRejected=[],"function"==typeof t){var e=this;t(function(t){f(e,t)},function(t){g(e,t)})}};c.prototype.then=function(t,e){var i=new c;return h(this,t,i),u(this,e,i),i},c.prototype["catch"]=function(t){return this.then(null,t)};var h=function(t,e,i){"function"!=typeof e&&(e=a);var n=function(t){d(e,t,i)};t._state===s?t._onFulfilled.push(n):t._state===r&&n(t._value)},u=function(t,e,i){"function"!=typeof e&&(e=l);var n=function(t){d(e,t,i)};t._state===s?t._onRejected.push(n):t._state===o&&n(t._reason)},d=function(t,e,i){n(function(){p(t,e,i)})},p=function(t,e,i){var n;try{n=t(e)}catch(t){return g(i,t)}n===i?g(i,new TypeError("Recursive promise chain detected")):f(i,n)},f=function(t,e){var i,n,s=!1;try{if(i=typeof e,"function"!=typeof(n=null!==e&&("function"===i||"object"===i)&&e.then))return m(t,e);n.call(e,function(e){s^(s=!0)&&f(t,e)},function(e){s^(s=!0)&&g(t,e)})}catch(e){if(!(s^(s=!0)))return;g(t,e)}},m=function(t,e){if(t._state===s){t._state=r,t._value=e,t._onRejected=[];for(var i,n=t._onFulfilled;i=n.shift();)i(e)}},g=function(t,e){if(t._state===s){t._state=o,t._reason=e,t._onFulfilled=[];for(var i,n=t._onRejected;i=n.shift();)i(e)}};c.resolve=function(t){return new c(function(e){e(t)})},c.reject=function(t){return new c(function(e,i){i(t)})},c.all=function(t){return new c(function(e,i){var n,s=[],r=t.length;if(0===r)return e(s);for(n=0;r>n;n++)!function(t,n){c.resolve(t).then(function(t){s[n]=t,0==--r&&e(s)},i)}(t[n],n)})},c.race=function(t){return new c(function(e,i){for(var n=0,s=t.length;s>n;n++)c.resolve(t[n]).then(e,i)})},c.deferred=c.pending=function(){var t={};return t.promise=new c(function(e,i){t.resolve=e,t.reject=i}),t},t.exports=c},function(t){"use strict";t.exports={isURI:function(t){return t&&t.protocol&&t.host&&t.path},isSameOrigin:function(t){return t.protocol===location.protocol&&t.hostname===location.hostname&&t.port===location.port},parse:function(t){if("string"!=typeof t)return t;var e,i,n,s,r,o,a={},l=function(e,i){t=t.replace(i,function(t){return a[e]=t,""}),a[e]=a[e]||""};for(l("protocol",/^[a-z]+\:/i),l("host",/^\/\/[^\/\?#]+/),/^\//.test(t)||a.host||(t=location.pathname.replace(/[^\/]*$/,"")+t),l("pathname",/^[^\?#]*/),l("search",/^\?[^#]*/),l("hash",/^#.*/),a.protocol=a.protocol||location.protocol,a.host?(a.host=a.host.substr(2),e=a.host.split(":"),a.hostname=e[0],a.port=e[1]||""):(a.host=location.host,a.hostname=location.hostname,a.port=location.port),a.pathname=a.pathname||"/",a.path=a.pathname+a.search,i=a.search.replace(/^\?/,""),n=i?i.split("&"):[],o={},s=0,r=n.length;r>s;s++)e=n[s].split("="),o[decodeURIComponent(e[0]||"")]=decodeURIComponent(e[1]||"");return a.query=o,a.href=this.stringify(a),a},stringify:function(t){var e=t.protocol+"//"+t.hostname;return t.port&&(e+=":"+t.port),e+=t.pathname+this.queryString(t.query)+(t.hash||"")},queryString:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return 0===e.length?"":"?"+e.join("&")}}},function(t){"use strict";t.exports={commonElement:function(t,e){for(var i=0,n=t.length;n>i;i++)if(-1!==this.indexOf(e,t[i]))return t[i];return null},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},map:function(t,e,i){if(t.map)return t.map(e,i);var n=[];if(t instanceof Array)for(var s=0,r=t.length;r>s;s++)n.push(e.call(i||null,t[s],s));else for(var o in t)t.hasOwnProperty(o)&&n.push(e.call(i||null,o,t[o]));return n},filter:function(t,e,i){if(t.filter)return t.filter(e,i);for(var n=[],s=0,r=t.length;r>s;s++)e.call(i||null,t[s],s)&&n.push(t[s]);return n},asyncEach:function(t,e,i,n){var s=t.length,r=-1,o=0,a=!1,l=function(){return o-=1,r+=1,r===s?i&&i.call(n):void e(t[r],h)},c=function(){if(!a){for(a=!0;o>0;)l();a=!1}},h=function(){o+=1,c()};h()}}},function(t,e){(function(e){"use strict";var i={_registry:[],on:function(t,e,i,n){var s=function(){i.call(n)};t.addEventListener?t.addEventListener(e,s,!1):t.attachEvent("on"+e,s),this._registry.push({_element:t,_type:e,_callback:i,_context:n,_handler:s})},detach:function(t,e,i,n){for(var s,r=this._registry.length;r--;)s=this._registry[r],t&&t!==s._element||e&&e!==s._type||i&&i!==s._callback||n&&n!==s._context||(s._element.removeEventListener?s._element.removeEventListener(s._type,s._handler,!1):s._element.detachEvent("on"+s._type,s._handler),this._registry.splice(r,1),s=null)}};void 0!==e.onunload&&i.on(e,"unload",i.detach,i),t.exports={Event:i}}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(11);t.exports=function(t,e){for(var i in t)if(n.indexOf(e,i)<0)throw new Error("Unrecognized option: "+i)}},function(t,e,i){(function(e){"use strict";var n=i(9);t.exports={then:function(t,e){var i=this;return this._promise||(this._promise=new n(function(t,e){i._resolve=t,i._reject=e})),0===arguments.length?this._promise:this._promise.then(t,e)},callback:function(t,e){return this.then(function(i){t.call(e,i)})},errback:function(t,e){return this.then(null,function(i){t.call(e,i)})},timeout:function(t,i){this.then();var n=this;this._timer=e.setTimeout(function(){n._reject(i)},1e3*t)},setDeferredStatus:function(t,i){this._timer&&e.clearTimeout(this._timer),this.then(),"succeeded"===t?this._resolve(i):"failed"===t?this._reject(i):delete this._promise}}}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(8),s=i(16),r={countListeners:function(t){return this.listeners(t).length},bind:function(t,e,i){var n=Array.prototype.slice,s=function(){e.apply(i,n.call(arguments))};return this._listeners=this._listeners||[],this._listeners.push([t,e,i,s]),this.on(t,s)},unbind:function(t,e,i){this._listeners=this._listeners||[];for(var n,s=this._listeners.length;s--;)n=this._listeners[s],n[0]===t&&(!e||n[1]===e&&n[2]===i)&&(this._listeners.splice(s,1),this.removeListener(t,n[3]))}};n(r,s.prototype),r.trigger=r.emit,t.exports=r},function(t){function e(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(e===t[i])return i;return-1}function i(){}var n="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=i,i.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||n(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var i=Array.prototype.slice.call(arguments,1);e.apply(this,i)}return!0}if(n(e)){for(var i=Array.prototype.slice.call(arguments,1),s=e.slice(),r=0,o=s.length;o>r;r++)s[r].apply(this,i);return!0}return!1},i.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",t,e),this._events[t]?n(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){var i=this;return i.on(t,function n(){i.removeListener(t,n),e.apply(this,arguments)}),this},i.prototype.removeListener=function(t,i){if("function"!=typeof i)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var s=this._events[t];if(n(s)){var r=e(s,i);if(0>r)return this;s.splice(r,1),0==s.length&&delete this._events[t]}else this._events[t]===i&&delete this._events[t];return this},i.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},i.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),n(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}},function(t,e,i){"use strict";var n=i(7),s=i(8),r=i(15),o=i(18),a=n({initialize:function(t){this.id=this.name=t},push:function(t){this.trigger("message",t)},isUnused:function(){return 0===this.countListeners("message")}});s(a.prototype,r),s(a,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(t){var e=this.parse(t),i=["/**",t],n=e.slice();n[n.length-1]="*",i.push(this.unparse(n));for(var s=1,r=e.length;r>s;s++)n=e.slice(0,s),n.push("**"),i.push(this.unparse(n));return i},isValid:function(t){return o.CHANNEL_NAME.test(t)||o.CHANNEL_PATTERN.test(t)},parse:function(t){return this.isValid(t)?t.split("/").slice(1):null},unparse:function(t){return"/"+t.join("/")},isMeta:function(t){var e=this.parse(t);return e?e[0]===this.META:null},isService:function(t){var e=this.parse(t);return e?e[0]===this.SERVICE:null},isSubscribable:function(t){return this.isValid(t)?!this.isMeta(t)&&!this.isService(t):null},Set:n({initialize:function(){this._channels={}},getKeys:function(){var t=[];for(var e in this._channels)t.push(e);return t},remove:function(t){delete this._channels[t]},hasSubscription:function(t){return this._channels.hasOwnProperty(t)},subscribe:function(t,e){for(var i,n=0,s=t.length;s>n;n++){i=t[n];(this._channels[i]=this._channels[i]||new a(i)).bind("message",e)}},unsubscribe:function(t,e){var i=this._channels[t];return!!i&&(i.unbind("message",e),!!i.isUnused()&&(this.remove(t),!0))},distributeMessage:function(t){for(var e=a.expand(t.channel),i=0,n=e.length;n>i;i++){var s=this._channels[e[i]];s&&s.trigger("message",t)}}})}),t.exports=a},function(t){"use strict";t.exports={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/}},function(t,e,i){(function(e){"use strict";var n=i(7),s=i(10),r=i(20),o=i(8),a=i(2),l=i(15),c=i(21),h=i(32),u=n({className:"Dispatcher",MAX_REQUEST_SIZE:2048,DEFAULT_RETRY:5,UP:1,DOWN:2,initialize:function(t,e,i){this._client=t,this.endpoint=s.parse(e),this._alternates=i.endpoints||{},this.cookies=r.CookieJar&&new r.CookieJar,this._disabled=[],this._envelopes={},this.headers={},this.retry=i.retry||this.DEFAULT_RETRY,this._scheduler=i.scheduler||h,this._state=0,this.transports={},this.wsExtensions=[],this.proxy=i.proxy||{},"string"==typeof this._proxy&&(this._proxy={origin:this._proxy});var n=i.websocketExtensions;if(n){n=[].concat(n);for(var o=0,a=n.length;a>o;o++)this.addWebsocketExtension(n[o])}this.tls=i.tls||{},this.tls.ca=this.tls.ca||i.ca;for(var l in this._alternates)this._alternates[l]=s.parse(this._alternates[l]);this.maxRequestSize=this.MAX_REQUEST_SIZE},endpointFor:function(t){return this._alternates[t]||this.endpoint},addWebsocketExtension:function(t){this.wsExtensions.push(t)},disable:function(t){this._disabled.push(t)},setHeader:function(t,e){this.headers[t]=e},close:function(){var t=this._transport;delete this._transport,t&&t.close()},getConnectionTypes:function(){return c.getConnectionTypes()},selectTransport:function(t){c.get(this,t,this._disabled,function(t){this.debug("Selected ? transport for ?",t.connectionType,s.stringify(t.endpoint)),t!==this._transport&&(this._transport&&this._transport.close(),this._transport=t,this.connectionType=t.connectionType)},this)},sendMessage:function(t,e,i){i=i||{};var n,s=t.id,r=i.attempts,o=i.deadline&&(new Date).getTime()+1e3*i.deadline,a=this._envelopes[s];a||(n=new this._scheduler(t,{timeout:e,interval:this.retry,attempts:r,deadline:o}),a=this._envelopes[s]={message:t,scheduler:n}),this._sendEnvelope(a)},_sendEnvelope:function(t){if(this._transport&&!t.request&&!t.timer){var i=t.message,n=t.scheduler,s=this;if(!n.isDeliverable())return n.abort(),void delete this._envelopes[i.id];t.timer=e.setTimeout(function(){s.handleError(i)},1e3*n.getTimeout()),n.send(),t.request=this._transport.sendMessage(i)}},handleResponse:function(t){var i=this._envelopes[t.id];void 0!==t.successful&&i&&(i.scheduler.succeed(),delete this._envelopes[t.id],e.clearTimeout(i.timer)),this.trigger("message",t),this._state!==this.UP&&(this._state=this.UP,this._client.trigger("transport:up"))},handleError:function(t,i){var n=this._envelopes[t.id],s=n&&n.request,r=this;if(s){s.then(function(t){t&&t.abort&&t.abort()});var o=n.scheduler;o.fail(),e.clearTimeout(n.timer),n.request=n.timer=null,i?this._sendEnvelope(n):n.timer=e.setTimeout(function(){n.timer=null,r._sendEnvelope(n)},1e3*o.getInterval()),
this._state!==this.DOWN&&(this._state=this.DOWN,this._client.trigger("transport:down"))}}});u.create=function(t,e,i){return new u(t,e,i)},o(u.prototype,l),o(u.prototype,a),t.exports=u}).call(e,function(){return this}())},function(t){"use strict";t.exports={}},function(t,e,i){"use strict";var n=i(22);n.register("websocket",i(24)),n.register("eventsource",i(28)),n.register("long-polling",i(29)),n.register("cross-origin-long-polling",i(30)),n.register("callback-polling",i(31)),t.exports=n},function(t,e,i){"use strict";var n=i(7),s=i(20).Cookie,r=i(9),o=i(10),a=i(11),l=i(8),c=i(2),h=i(23),u=i(17),d=l(n({className:"Transport",DEFAULT_PORTS:{"http:":80,"https:":443,"ws:":80,"wss:":443},MAX_DELAY:0,batching:!0,initialize:function(t,e){this._dispatcher=t,this.endpoint=e,this._outbox=[],this._proxy=l({},this._dispatcher.proxy),this._proxy.origin||(this._proxy.origin=this._findProxy())},close:function(){},encode:function(){return""},sendMessage:function(t){return this.debug("Client ? sending message to ?: ?",this._dispatcher.clientId,o.stringify(this.endpoint),t),this.batching?(this._outbox.push(t),this._flushLargeBatch(),t.channel===u.HANDSHAKE?this._publish(.01):(t.channel===u.CONNECT&&(this._connectMessage=t),this._publish(this.MAX_DELAY))):r.resolve(this.request([t]))},_makePromise:function(){var t=this;this._requestPromise=this._requestPromise||new r(function(e){t._resolvePromise=e})},_publish:function(t){return this._makePromise(),this.addTimeout("publish",t,function(){this._flush(),delete this._requestPromise},this),this._requestPromise},_flush:function(){this.removeTimeout("publish"),this._outbox.length>1&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this._resolvePromise(this.request(this._outbox)),this._connectMessage=null,this._outbox=[]},_flushLargeBatch:function(){if(!(this.encode(this._outbox).length<this._dispatcher.maxRequestSize)){var t=this._outbox.pop();this._makePromise(),this._flush(),t&&this._outbox.push(t)}},_receive:function(t){if(t){t=[].concat(t),this.debug("Client ? received from ? via ?: ?",this._dispatcher.clientId,o.stringify(this.endpoint),this.connectionType,t);for(var e=0,i=t.length;i>e;e++)this._dispatcher.handleResponse(t[e])}},_handleError:function(t){t=[].concat(t),this.debug("Client ? failed to send to ? via ?: ?",this._dispatcher.clientId,o.stringify(this.endpoint),this.connectionType,t);for(var e=0,i=t.length;i>e;e++)this._dispatcher.handleError(t[e])},_getCookies:function(){var t=this._dispatcher.cookies,e=o.stringify(this.endpoint);return t?a.map(t.getCookiesSync(e),function(t){return t.cookieString()}).join("; "):""},_storeCookies:function(t){var e,i=this._dispatcher.cookies,n=o.stringify(this.endpoint);if(t&&i){t=[].concat(t);for(var r=0,a=t.length;a>r;r++)e=s.parse(t[r]),i.setCookieSync(e,n)}},_findProxy:function(){if("undefined"!=typeof process){var t=this.endpoint.protocol;if(t){var e,i,n=t.replace(/:$/,"").toLowerCase()+"_proxy",s=n.toUpperCase(),r=process.env;return"http_proxy"===n&&r.REQUEST_METHOD?(e=Object.keys(r).filter(function(t){return/^http_proxy$/i.test(t)}),1===e.length?e[0]===n&&void 0===r[s]&&(i=r[n]):e.length>1&&(i=r[n]),i=i||r["CGI_"+s]):(i=r[n]||r[s])&&!r[n]&&console.warn("The environment variable "+s+" is discouraged. Use "+n+"."),i}}}}),{get:function(t,e,i,n,s){var r=t.endpoint;a.asyncEach(this._transports,function(r,o){var l=r[0],c=r[1],h=t.endpointFor(l);return a.indexOf(i,l)>=0?o():a.indexOf(e,l)<0?(c.isUsable(t,h,function(){}),o()):void c.isUsable(t,h,function(e){if(!e)return o();var i=c.hasOwnProperty("create")?c.create(t,h):new c(t,h);n.call(s,i)})},function(){throw new Error("Could not find a usable connection type for "+o.stringify(r))})},register:function(t,e){this._transports.push([t,e]),e.prototype.connectionType=t},getConnectionTypes:function(){return a.map(this._transports,function(t){return t[0]})},_transports:[]});l(d.prototype,c),l(d.prototype,h),t.exports=d},function(t,e){(function(e){"use strict";t.exports={addTimeout:function(t,i,n,s){if(this._timeouts=this._timeouts||{},!this._timeouts.hasOwnProperty(t)){var r=this;this._timeouts[t]=e.setTimeout(function(){delete r._timeouts[t],n.call(s)},1e3*i)}},removeTimeout:function(t){this._timeouts=this._timeouts||{};var i=this._timeouts[t];i&&(e.clearTimeout(i),delete this._timeouts[t])},removeAllTimeouts:function(){this._timeouts=this._timeouts||{};for(var t in this._timeouts)this.removeTimeout(t)}}}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(7),s=i(9),r=i(25),o=i(10),a=i(12),l=i(26),c=i(8),h=i(3),u=i(27),d=i(14),p=i(22),f=c(n(p,{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)}),this.connect()},request:function(t){this._pending=this._pending||new r;for(var e=0,i=t.length;i>e;e++)this._pending.add(t[e]);var n=this,o=new s(function(e){n.callback(function(i){i&&1===i.readyState&&(i.send(h(t)),e(i))}),n.connect()});return{abort:function(){o.then(function(t){t.close()})}}},connect:function(){if(!f._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var t=this._createSocket();if(!t)return this.setDeferredStatus("failed");var e=this;t.onopen=function(){t.headers&&e._storeCookies(t.headers["set-cookie"]),e._socket=t,e._state=e.CONNECTED,e._everConnected=!0,e._ping(),e.setDeferredStatus("succeeded",t)};var i=!1;t.onclose=t.onerror=function(){if(!i){i=!0;var n=e._state===e.CONNECTED;t.onopen=t.onclose=t.onerror=t.onmessage=null,delete e._socket,e._state=e.UNCONNECTED,e.removeTimeout("ping");var s=e._pending?e._pending.toArray():[];delete e._pending,n||e._everConnected?(e.setDeferredStatus("unknown"),e._handleError(s,n)):e.setDeferredStatus("failed")}},t.onmessage=function(t){var i;try{i=JSON.parse(t.data)}catch(t){}if(i){i=[].concat(i);for(var n=0,s=i.length;s>n;n++)void 0!==i[n].successful&&e._pending.remove(i[n]);e._receive(i)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var t=f.getSocketUrl(this.endpoint),e=this._dispatcher.headers,i=this._dispatcher.wsExtensions,n=this._getCookies(),s=this._dispatcher.tls,r={extensions:i,headers:e,proxy:this._proxy,tls:s};return""!==n&&(r.headers.Cookie=n),u.create(t,[],r)},_ping:function(){this._socket&&1===this._socket.readyState&&(this._socket.send("[]"),this.addTimeout("ping",this._dispatcher.timeout/2,this._ping,this))}}),{PROTOCOLS:{"http:":"ws:","https:":"wss:"},create:function(t,e){var i=t.transports.websocket=t.transports.websocket||{};return i[e.href]=i[e.href]||new this(t,e),i[e.href]},getSocketUrl:function(t){return t=l(t),t.protocol=this.PROTOCOLS[t.protocol],o.stringify(t)},isUsable:function(t,e,i,n){this.create(t,e).isUsable(i,n)}});c(f.prototype,d),a.Event&&void 0!==e.onbeforeunload&&a.Event.on(e,"beforeunload",function(){f._unloaded=!0}),t.exports=f}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(7);t.exports=n({initialize:function(){this._index={}},add:function(t){var e=void 0!==t.id?t.id:t;return!this._index.hasOwnProperty(e)&&(this._index[e]=t,!0)},forEach:function(t,e){for(var i in this._index)this._index.hasOwnProperty(i)&&t.call(e,this._index[i])},isEmpty:function(){for(var t in this._index)if(this._index.hasOwnProperty(t))return!1;return!0},member:function(t){for(var e in this._index)if(this._index[e]===t)return!0;return!1},remove:function(t){var e=void 0!==t.id?t.id:t,i=this._index[e];return delete this._index[e],i},toArray:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}})},function(t){"use strict";var e=function(t){var i,n,s;if(t instanceof Array){for(i=[],n=t.length;n--;)i[n]=e(t[n]);return i}if("object"==typeof t){i=null===t?null:{};for(s in t)i[s]=e(t[s]);return i}return t};t.exports=e},function(t,e){(function(e){"use strict";var i=e.MozWebSocket||e.WebSocket;t.exports={create:function(t){return"function"!=typeof i?null:new i(t)}}}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(7),s=i(10),r=i(26),o=i(8),a=i(14),l=i(22),c=i(29),h=o(n(l,{initialize:function(t,i){if(l.prototype.initialize.call(this,t,i),!e.EventSource)return this.setDeferredStatus("failed");this._xhr=new c(t,i),i=r(i),i.pathname+="/"+t.clientId;var n=new e.EventSource(s.stringify(i)),o=this;n.onopen=function(){o._everConnected=!0,o.setDeferredStatus("succeeded")},n.onerror=function(){o._everConnected?o._handleError([]):(o.setDeferredStatus("failed"),n.close())},n.onmessage=function(t){var e;try{e=JSON.parse(t.data)}catch(t){}e?o._receive(e):o._handleError([])},this._socket=n},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)})},encode:function(t){return this._xhr.encode(t)},request:function(t){return this._xhr.request(t)}}),{isUsable:function(t,e,i,n){return t.clientId?void c.isUsable(t,e,function(s){return s?void this.create(t,e).isUsable(i,n):i.call(n,!1)},this):i.call(n,!1)},create:function(t,e){var i=t.transports.eventsource=t.transports.eventsource||{},n=t.clientId,o=r(e);return o.pathname+="/"+(n||""),o=s.stringify(o),i[o]=i[o]||new this(t,e),i[o]}});o(h.prototype,a),t.exports=h}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(7),s=i(10),r=i(12),o=i(8),a=i(3),l=i(22),c=o(n(l,{encode:function(t){return a(t)},request:function(t){var i,n=this.endpoint.href,s=this;if(e.XMLHttpRequest)i=new XMLHttpRequest;else{if(!e.ActiveXObject)return this._handleError(t);i=new ActiveXObject("Microsoft.XMLHTTP")}i.open("POST",n,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Pragma","no-cache"),i.setRequestHeader("X-Requested-With","XMLHttpRequest");var o=this._dispatcher.headers;for(var a in o)o.hasOwnProperty(a)&&i.setRequestHeader(a,o[a]);var l=function(){i.abort()};return void 0!==e.onbeforeunload&&r.Event.on(e,"beforeunload",l),i.onreadystatechange=function(){if(i&&4===i.readyState){var n=null,o=i.status,a=i.responseText,c=o>=200&&300>o||304===o||1223===o;if(void 0!==e.onbeforeunload&&r.Event.detach(e,"beforeunload",l),i.onreadystatechange=function(){},i=null,!c)return s._handleError(t);try{n=JSON.parse(a)}catch(t){}n?s._receive(n):s._handleError(t)}},i.send(this.encode(t)),i}}),{isUsable:function(t,e,i,n){var r="ReactNative"===navigator.product||s.isSameOrigin(e);i.call(n,r)}});t.exports=c}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(7),s=i(25),r=i(10),o=i(8),a=i(3),l=i(22),c=o(n(l,{encode:function(t){return"message="+encodeURIComponent(a(t))},request:function(t){var i,n=e.XDomainRequest?XDomainRequest:XMLHttpRequest,s=new n,o=++c._id,a=this._dispatcher.headers,l=this;if(s.open("POST",r.stringify(this.endpoint),!0),s.setRequestHeader){s.setRequestHeader("Pragma","no-cache");for(i in a)a.hasOwnProperty(i)&&s.setRequestHeader(i,a[i])}var h=function(){return!!s&&(c._pending.remove(o),s.onload=s.onerror=s.ontimeout=s.onprogress=null,void(s=null))};return s.onload=function(){var e;try{e=JSON.parse(s.responseText)}catch(t){}h(),e?l._receive(e):l._handleError(t)},s.onerror=s.ontimeout=function(){h(),l._handleError(t)},s.onprogress=function(){},n===e.XDomainRequest&&c._pending.add({id:o,xhr:s}),s.send(this.encode(t)),s}}),{_id:0,_pending:new s,isUsable:function(t,i,n,s){if(r.isSameOrigin(i))return n.call(s,!1);if(e.XDomainRequest)return n.call(s,i.protocol===location.protocol);if(e.XMLHttpRequest){var o=new XMLHttpRequest;return n.call(s,void 0!==o.withCredentials)}return n.call(s,!1)}});t.exports=c}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(7),s=i(10),r=i(26),o=i(8),a=i(3),l=i(22),c=o(n(l,{encode:function(t){var e=r(this.endpoint);return e.query.message=a(t),e.query.jsonp="__jsonp"+c._cbCount+"__",s.stringify(e)},request:function(t){var i=document.getElementsByTagName("head")[0],n=document.createElement("script"),o=c.getCallbackName(),l=r(this.endpoint),h=this;l.query.message=a(t),l.query.jsonp=o;var u=function(){if(!e[o])return!1;e[o]=void 0;try{delete e[o]}catch(t){}n.parentNode.removeChild(n)};return e[o]=function(t){u(),h._receive(t)},n.type="text/javascript",n.src=s.stringify(l),i.appendChild(n),n.onerror=function(){u(),h._handleError(t)},{abort:u}}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,"__jsonp"+this._cbCount+"__"},isUsable:function(t,e,i,n){i.call(n,!0)}});t.exports=c}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(8),s=function(t,e){this.message=t,this.options=e,this.attempts=0};n(s.prototype,{getTimeout:function(){return this.options.timeout},getInterval:function(){return this.options.interval},isDeliverable:function(){var t=this.options.attempts,e=this.attempts,i=this.options.deadline,n=(new Date).getTime();return!(void 0!==t&&e>=t)&&!(void 0!==i&&n>i)},send:function(){this.attempts+=1},succeed:function(){},fail:function(){},abort:function(){}}),t.exports=s},function(t,e,i){"use strict";var n=i(7),s=i(18),r=n({initialize:function(t,e,i){this.code=t,this.params=Array.prototype.slice.call(e),this.message=i},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message}});r.parse=function(t){if(t=t||"",!s.ERROR.test(t))return new r(null,[],t);var e=t.split(":"),i=parseInt(e[0]),n=e[1].split(","),t=e[2];return new r(i,n,t)};var o={versionMismatch:[300,"Version mismatch"],conntypeMismatch:[301,"Connection types not supported"],extMismatch:[302,"Extension mismatch"],badRequest:[400,"Bad request"],clientUnknown:[401,"Unknown client"],parameterMissing:[402,"Missing required parameter"],channelForbidden:[403,"Forbidden channel"],channelUnknown:[404,"Unknown channel"],channelInvalid:[405,"Invalid channel"],extUnknown:[406,"Unknown extension"],publishFailed:[407,"Failed to publish"],serverError:[500,"Internal server error"]};for(var a in o)!function(t){r[t]=function(){return new r(o[t][0],arguments,o[t][1]).toString()}}(a);t.exports=r},function(t,e,i){"use strict";var n=i(8),s=i(2),r={addExtension:function(t){this._extensions=this._extensions||[],this._extensions.push(t),t.added&&t.added(this)},removeExtension:function(t){if(this._extensions)for(var e=this._extensions.length;e--;)this._extensions[e]===t&&(this._extensions.splice(e,1),t.removed&&t.removed(this))},pipeThroughExtensions:function(t,e,i,n,s){if(this.debug("Passing through ? extensions: ?",t,e),!this._extensions)return n.call(s,e);var r=this._extensions.slice(),o=function(e){if(!e)return n.call(s,e);var a=r.shift();if(!a)return n.call(s,e);var l=a[t];return l?void(l.length>=3?a[t](e,i,o):a[t](e,o)):o(e)};o(e)}};n(r,s),t.exports=r},function(t,e,i){"use strict";var n=i(7),s=i(14);t.exports=n(s)},function(t,e,i){"use strict";var n=i(7),s=i(8),r=i(14),o=n({initialize:function(t,e,i,n){this._client=t,this._channels=e,this._callback=i,this._context=n,this._cancelled=!1},withChannel:function(t,e){return this._withChannel=[t,e],this},apply:function(t,e){var i=e[0];this._callback&&this._callback.call(this._context,i.data),this._withChannel&&this._withChannel[0].call(this._withChannel[1],i.channel,i.data)},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this),this._cancelled=!0)},unsubscribe:function(){this.cancel()}});s(o.prototype,r),t.exports=o}]);FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),FastClick.prototype.needsClick=function(t){"use strict";switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===t.type||t.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(t.className)},FastClick.prototype.needsFocus=function(t){"use strict";switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!this.deviceIsAndroid;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},FastClick.prototype.sendClick=function(t,e){"use strict";var i,n;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),n=e.changedTouches[0],i=document.createEvent("MouseEvents"),i.initMouseEvent(this.determineEventType(t),!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,t.dispatchEvent(i)},FastClick.prototype.determineEventType=function(t){"use strict";return this.deviceIsAndroid&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(t){"use strict";var e;this.deviceIsIOS&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},FastClick.prototype.updateScrollParent=function(t){"use strict";var e,i;if(!(e=t.fastClickScrollParent)||!e.contains(t)){i=t;do{if(i.scrollHeight>i.offsetHeight){e=i,t.fastClickScrollParent=i;break}i=i.parentElement}while(i)}e&&(e.fastClickLastScrollTop=e.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(t){"use strict";return t.nodeType===Node.TEXT_NODE?t.parentNode:t},FastClick.prototype.onTouchStart=function(t){"use strict";var e,i,n;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),i=t.targetTouches[0],this.deviceIsIOS){if(n=window.getSelection(),n.rangeCount&&!n.isCollapsed)return!0;if(!this.deviceIsIOS4){if(i.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=i.pageX,this.touchStartY=i.pageY,t.timeStamp-this.lastClickTime<200&&t.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(t){"use strict";var e=t.changedTouches[0],i=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>i||Math.abs(e.pageY-this.touchStartY)>i},FastClick.prototype.onTouchMove=function(t){"use strict";return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0)},FastClick.prototype.findControl=function(t){"use strict";return t.control!==undefined?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(t){"use strict";var e,i,n,s,r,o=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,i=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(r=t.changedTouches[0],o=document.elementFromPoint(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(n=o.tagName.toLowerCase())){if(e=this.findControl(o)){if(this.focus(o),this.deviceIsAndroid)return!1;o=e}}else if(this.needsFocus(o))return t.timeStamp-i>100||this.deviceIsIOS&&window.top!==window&&"input"===n?(this.targetElement=null,!1):(this.focus(o),this.deviceIsIOS4&&"select"===n||(this.targetElement=null,t.preventDefault()),!1);return!(!this.deviceIsIOS||this.deviceIsIOS4||!(s=o.fastClickScrollParent)||s.fastClickLastScrollTop===s.scrollTop)||(this.needsClick(o)||(t.preventDefault(),this.sendClick(o,t)),!1)},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(t){"use strict";return!this.targetElement||(!!t.forwardedTouchEvent||(!t.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1))))},FastClick.prototype.onClick=function(t){"use strict";var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail||(e=this.onMouse(t),e||(this.targetElement=null),e)},FastClick.prototype.destroy=function(){"use strict";var t=this.layer;this.deviceIsAndroid&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(t){"use strict";var e,i;if("undefined"==typeof window.ontouchstart)return!0;if(i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!FastClick.prototype.deviceIsAndroid)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(i>31&&window.innerWidth<=window.screen.width)return!0}}return"none"===t.style.msTouchAction},FastClick.attach=function(t){"use strict";return new FastClick(t)},"undefined"!=typeof define&&define.amd?define(function(){"use strict";return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,function(t){t.fn.zclip=function(e){if("object"==typeof e&&!e.length){var i=t.extend({path:"ZeroClipboard.swf",copy:null,beforeCopy:null,afterCopy:null,clickAfter:!0,setHandCursor:!0,setCSSEffects:!0},e);return this.each(function(){var e=t(this);if(e.is(":visible")&&("string"==typeof i.copy||t.isFunction(i.copy))){ZeroClipboard.setMoviePath(i.path);var n=new ZeroClipboard.Client;t.isFunction(i.copy)&&e.bind("zClip_copy",i.copy),t.isFunction(i.beforeCopy)&&e.bind("zClip_beforeCopy",i.beforeCopy),t.isFunction(i.afterCopy)&&e.bind("zClip_afterCopy",i.afterCopy),n.setHandCursor(i.setHandCursor),n.setCSSEffects(i.setCSSEffects),n.addEventListener("mouseOver",function(){e.trigger("mouseenter")}),n.addEventListener("mouseOut",function(){e.trigger("mouseleave")}),n.addEventListener("mouseDown",function(){e.trigger("mousedown"),t.isFunction(i.copy)?n.setText(e.triggerHandler("zClip_copy")):n.setText(i.copy),t.isFunction(i.beforeCopy)&&e.trigger("zClip_beforeCopy")}),n.addEventListener("complete",function(n,s){t.isFunction(i.afterCopy)?e.trigger("zClip_afterCopy"):(s.length>500&&(s=s.substr(0,500)+"...\n\n("+(s.length-500)+" characters not shown)"),e.removeClass("hover"),alert("Copied text to clipboard:\n\n "+s)),i.clickAfter&&e.trigger("click")}),n.glue(e[0],e.parent()[0]),t(window).bind("load resize",function(){n.reposition()})}})}if("string"==typeof e)return this.each(function(){var i=t(this);e=e.toLowerCase();var n=i.data("zclipId"),s=t("#"+n+".zclip");"remove"==e?(s.remove(),i.removeClass("active hover")):"hide"==e?(s.hide(),i.removeClass("active hover")):"show"==e&&s.show()})}}(jQuery);var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(t){return"string"==typeof t&&(t=document.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(t){this.removeClass(t),this.className+=" "+t},t.removeClass=function(t){for(var e=this.className.split(/\s+/),i=-1,n=0;n<e.length;n++)e[n]==t&&(i=n,n=e.length);return i>-1&&(e.splice(i,1),this.className=e.join(" ")),this},t.hasClass=function(t){return!!this.className.match(new RegExp("\\s*"+t+"\\s*"))}),t},setMoviePath:function(t){this.moviePath=t},dispatch:function(t,e,i){var n=this.clients[t];n&&n.receiveEvent(e,i)},register:function(t,e){this.clients[t]=e},getDOMObjectPosition:function(t,e){var i={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};return t&&t!=e&&(i.left+=t.offsetLeft,i.top+=t.offsetTop),i},Client:function(t){this.handlers={},this.id=ZeroClipboard.nextId++,this.movieId="ZeroClipboardMovie_"+this.id,ZeroClipboard.register(this.id,this),t&&this.glue(t)}};ZeroClipboard.Client.prototype={id:0,ready:!1,movie:null,clipText:"",handCursorEnabled:!0,cssEffects:!0,handlers:null,glue:function(t,e,i){this.domElement=ZeroClipboard.$(t);var n=99;this.domElement.style.zIndex&&(n=parseInt(this.domElement.style.zIndex,10)+1),"string"==typeof e?e=ZeroClipboard.$(e):void 0===e&&(e=document.getElementsByTagName("body")[0]);var s=ZeroClipboard.getDOMObjectPosition(this.domElement,e);this.div=document.createElement("div"),this.div.className="zclip",this.div.id="zclip-"+this.movieId,$(this.domElement).data("zclipId","zclip-"+this.movieId);var r=this.div.style;if(r.position="absolute",r.left=s.left+"px",r.top=s.top+"px",r.width=s.width+"px",r.height=s.height+"px",r.zIndex=n,"object"==typeof i)for(addedStyle in i)r[addedStyle]=i[addedStyle];e.appendChild(this.div),this.div.innerHTML=this.getHTML(s.width,s.height)},getHTML:function(t,e){var i="",n="id="+this.id+"&width="+t+"&height="+e;if(navigator.userAgent.match(/MSIE/)){i+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+(location.href.match(/^https/i)?"https://":"http://")+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+t+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+n+'"/><param name="wmode" value="transparent"/></object>'}else i+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+n+'" wmode="transparent" />';return i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var t=document.getElementsByTagName("body")[0];try{t.removeChild(this.div)}catch(t){}this.domElement=null,this.div=null}},reposition:function(t){if(t&&(this.domElement=ZeroClipboard.$(t),this.domElement||this.hide()),this.domElement&&this.div){var e=ZeroClipboard.getDOMObjectPosition(this.domElement),i=this.div.style;i.left=e.left+"px",i.top=e.top+"px"}},setText:function(t){this.clipText=t,this.ready&&this.movie.setText(t)},addEventListener:function(t,e){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},setHandCursor:function(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(t,e){switch(t=t.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie){var i=this;return void setTimeout(function(){i.receiveEvent("load",null)},1)}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var i=this;return setTimeout(function(){i.receiveEvent("load",null)},100),void(this.ready=!0)}this.ready=!0;try{this.movie.setText(this.clipText)}catch(t){}try{this.movie.setHandCursor(this.handCursorEnabled)}catch(t){}break;case"mouseover":this.domElement&&this.cssEffects&&(this.domElement.addClass("hover"),this.recoverActive&&this.domElement.addClass("active"));break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0),this.domElement.removeClass("hover"));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[t])for(var n=0,s=this.handlers[t].length;n<s;n++){var r=this.handlers[t][n];"function"==typeof r?r(this,e):"object"==typeof r&&2==r.length?r[0][r[1]](this,e):"string"==typeof r&&window[r](this,e)}}},function(t){if("function"==typeof define&&define.amd)define(t);else if("object"==typeof exports)module.exports=t();else{var e=window.Cookies,i=window.Cookies=t();i.noConflict=function(){return window.Cookies=e,i}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(i){function n(e,s,r){var o;if(arguments.length>1){if(r=t({path:"/"},n.defaults,r),"number"==typeof r.expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*r.expires),r.expires=a}try{o=JSON.stringify(s),/^[\{\[]/.test(o)&&(s=o)}catch(t){}return s=encodeURIComponent(String(s)),s=s.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape),document.cookie=[e,"=",s,r.expires&&"; expires="+r.expires.toUTCString(),r.path&&"; path="+r.path,r.domain&&"; domain="+r.domain,r.secure?"; secure":""].join("")}e||(o={});for(var l=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,h=0;h<l.length;h++){var u=l[h].split("="),d=u[0].replace(c,decodeURIComponent),p=u.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{if(p=i&&i(p,d)||p.replace(c,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===d){o=p;break}e||(o[d]=p)}catch(t){}}return o}return n.get=n.set=n,n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,i){n(e,"",t(i,{expires:-1}))},n.withConverter=e,n}return e()}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(){var e=i(this),o=r.settings;return isNaN(e.datetime)||(0==o.cutoff||s(e.datetime)<o.cutoff)&&t(this).text(n(e.datetime)),this}function i(e){if(e=t(e),!e.data("timeago")){e.data("timeago",{datetime:r.datetime(e)});var i=t.trim(e.text());r.settings.localeTitle?e.attr("title",e.data("timeago").datetime.toLocaleString()):!(i.length>0)||r.isTime(e)&&e.attr("title")||e.attr("title",i)}return e.data("timeago")}function n(t){return r.inWords(s(t))}function s(t){return(new Date).getTime()-t.getTime()}t.timeago=function(e){return n(e instanceof Date?e:"string"==typeof e?t.timeago.parse(e):"number"==typeof e?new Date(e):t.timeago.datetime(e))};var r=t.timeago;t.extend(t.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(e){function i(i,s){var r=t.isFunction(i)?i(s,e):i,o=n.numbers&&n.numbers[s]||s;return r.replace(/%d/i,o)}var n=this.settings.strings,s=n.prefixAgo,r=n.suffixAgo;this.settings.allowFuture&&e<0&&(s=n.prefixFromNow,r=n.suffixFromNow);var o=Math.abs(e)/1e3,a=o/60,l=a/60,c=l/24,h=c/365,u=o<45&&i(n.seconds,Math.round(o))||o<90&&i(n.minute,1)||a<45&&i(n.minutes,Math.round(a))||a<90&&i(n.hour,1)||l<24&&i(n.hours,Math.round(l))||l<42&&i(n.day,1)||c<30&&i(n.days,Math.round(c))||c<45&&i(n.month,1)||c<365&&i(n.months,Math.round(c/30))||h<1.5&&i(n.year,1)||i(n.years,Math.round(h)),d=n.wordSeparator||"";return n.wordSeparator===undefined&&(d=" "),t.trim([s,u,r].join(d))},parse:function(e){var i=t.trim(e);return i=i.replace(/\.\d+/,""),i=i.replace(/-/,"/").replace(/-/,"/"),i=i.replace(/T/," ").replace(/Z/," UTC"),i=i.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),i=i.replace(/([\+\-]\d\d)$/," $100"),new Date(i)},datetime:function(e){var i=r.isTime(e)?t(e).attr("datetime"):t(e).attr("title");return r.parse(i)},isTime:function(e){return"time"===t(e).get(0).tagName.toLowerCase()}});var o={init:function(){var i=t.proxy(e,this);i();var n=r.settings;n.refreshMillis>0&&(this._timeagoInterval=setInterval(i,n.refreshMillis))},update:function(i){var n=r.parse(i)
;t(this).data("timeago",{datetime:n}),r.settings.localeTitle&&t(this).attr("title",n.toLocaleString()),e.apply(this)},updateFromDOM:function(){t(this).data("timeago",{datetime:r.parse(r.isTime(this)?t(this).attr("datetime"):t(this).attr("title"))}),e.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};t.fn.timeago=function(t,e){var i=t?o[t]:o.init;if(!i)throw new Error("Unknown function name '"+t+"' for timeago");return this.each(function(){i.call(this,e)}),this},document.createElement("abbr"),document.createElement("time")});var Handlebars=function(){var t=function(){"use strict";function t(t){this.string=t}return t.prototype.toString=function(){return""+this.string},t}(),e=function(t){"use strict";function e(t){return a[t]||"&amp;"}function i(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}function n(t){return t instanceof o?t.toString():t||0===t?(t=""+t,c.test(t)?t.replace(l,e):t):""}function s(t){return!t&&0!==t||!(!d(t)||0!==t.length)}var r={},o=t,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,c=/[&<>"'`]/;r.extend=i;var h=Object.prototype.toString;r.toString=h;var u=function(t){return"function"==typeof t};u(/x/)&&(u=function(t){return"function"==typeof t&&"[object Function]"===h.call(t)});var u;r.isFunction=u;var d=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===h.call(t)};return r.isArray=d,r.escapeExpression=n,r.isEmpty=s,r}(t),i=function(){"use strict";function t(){for(var t=Error.prototype.constructor.apply(this,arguments),i=0;i<e.length;i++)this[e[i]]=t[e[i]]}var e=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=new Error,t}(),n=function(t,e){"use strict";function i(t,e){this.helpers=t||{},this.partials=e||{},n(this)}function n(t){t.registerHelper("helperMissing",function(t){if(2===arguments.length)return undefined;throw new Error("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,i){var n=i.inverse||function(){},s=i.fn;return h(e)&&(e=e.call(this)),!0===e?s(this):!1===e||null==e?n(this):c(e)?e.length>0?t.helpers.each(e,i):n(this):s(e)}),t.registerHelper("each",function(t,e){var i,n=e.fn,s=e.inverse,r=0,o="";if(h(t)&&(t=t.call(this)),e.data&&(i=f(e.data)),t&&"object"==typeof t)if(c(t))for(var a=t.length;r<a;r++)i&&(i.index=r,i.first=0===r,i.last=r===t.length-1),o+=n(t[r],{data:i});else for(var l in t)t.hasOwnProperty(l)&&(i&&(i.key=l,i.index=r,i.first=0===r),o+=n(t[l],{data:i}),r++);return 0===r&&(o=s(this)),o}),t.registerHelper("if",function(t,e){return h(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),t.registerHelper("with",function(t,e){if(h(t)&&(t=t.call(this)),!o.isEmpty(t))return e.fn(t)}),t.registerHelper("log",function(e,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;t.log(n,e)})}function s(t,e){p.log(t,e)}var r={},o=t,a=e;r.VERSION="1.2.0",r.COMPILER_REVISION=4;var l={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};r.REVISION_CHANGES=l;var c=o.isArray,h=o.isFunction,u=o.toString,d="[object Object]";r.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:p,log:s,registerHelper:function(t,e,i){if(u.call(t)===d){if(i||e)throw new a("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else i&&(e.not=i),this.helpers[t]=e},registerPartial:function(t,e){u.call(t)===d?o.extend(this.partials,t):this.partials[t]=e}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(p.level<=t){var i=p.methodMap[t];"undefined"!=typeof console&&console[i]&&console[i].call(console,e)}}};r.logger=p,r.log=s;var f=function(t){var e={};return o.extend(e,t),e};return r.createFrame=f,r}(e,i),s=function(t,e,i){"use strict";function n(t){var e=t&&t[0]||1,i=d;if(e!==i){if(e<i){var n=p[i],s=p[e];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+s+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function s(t,e){if(!e)throw new Error("No environment passed to template");var i=function(t,i,n,s,r,o){var a=e.VM.invokePartial.apply(this,arguments);if(null!=a)return a;if(e.compile){var l={helpers:s,partials:r,data:o};return r[i]=e.compile(t,{data:o!==undefined},e),r[i](n,l)}throw new u("The partial "+i+" could not be compiled when running in runtime-only mode")},n={escapeExpression:h.escapeExpression,invokePartial:i,programs:[],program:function(t,e,i){var n=this.programs[t];return i?n=o(t,e,i):n||(n=this.programs[t]=o(t,e)),n},merge:function(t,e){var i=t||e;return t&&e&&t!==e&&(i={},h.extend(i,e),h.extend(i,t)),i},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(i,s){s=s||{};var r,o,a=s.partial?s:e;s.partial||(r=s.helpers,o=s.partials);var l=t.call(n,a,i,r,o,s.data);return s.partial||e.VM.checkRevision(n.compilerInfo),l}}function r(t,e,i){var n=Array.prototype.slice.call(arguments,3),s=function(t,s){return s=s||{},e.apply(this,[t,s.data||i].concat(n))};return s.program=t,s.depth=n.length,s}function o(t,e,i){var n=function(t,n){return n=n||{},e(t,n.data||i)};return n.program=t,n.depth=0,n}function a(t,e,i,n,s,r){var o={partial:!0,helpers:n,partials:s,data:r};if(t===undefined)throw new u("The partial "+e+" could not be found");if(t instanceof Function)return t(i,o)}function l(){return""}var c={},h=t,u=e,d=i.COMPILER_REVISION,p=i.REVISION_CHANGES;return c.checkRevision=n,c.template=s,c.programWithDepth=r,c.program=o,c.invokePartial=a,c.noop=l,c}(e,i,n),r=function(t,e,i,n,s){"use strict";var r=t,o=e,a=i,l=n,c=s,h=function(){var t=new r.HandlebarsEnvironment;return l.extend(t,r),t.SafeString=o,t.Exception=a,t.Utils=l,t.VM=c,t.template=function(e){return c.template(e,t)},t},u=h();return u.create=h,u}(n,t,i,e,s),o=function(t){"use strict";var e=t,i={ProgramNode:function(t,e,n){this.type="program",this.statements=t,this.strip={},n?(this.inverse=new i.ProgramNode(n,e),this.strip.right=e.left):e&&(this.strip.left=e.right)},MustacheNode:function(t,e,i,n){if(this.type="mustache",this.hash=e,this.strip=n,null!=i&&i.charAt){var s=i.charAt(3)||i.charAt(2);this.escaped="{"!==s&&"&"!==s}else this.escaped=!!i;var r=this.id=t[0],o=this.params=t.slice(1),a=this.eligibleHelper=r.isSimple;this.isHelper=a&&(o.length||e)},PartialNode:function(t,e,i){this.type="partial",this.partialName=t,this.context=e,this.strip=i},BlockNode:function(t,i,n,s){if(t.id.original!==s.path.original)throw new e(t.id.original+" doesn't match "+s.path.original);this.type="block",this.mustache=t,this.program=i,this.inverse=n,this.strip={left:t.strip.left,right:s.strip.right},(i||n).strip.left=t.strip.right,(n||i).strip.right=s.strip.left,n&&!i&&(this.isInverse=!0)},ContentNode:function(t){this.type="content",this.string=t},HashNode:function(t){this.type="hash",this.pairs=t},IdNode:function(t){this.type="ID";for(var i="",n=[],s=0,r=0,o=t.length;r<o;r++){var a=t[r].part;if(i+=(t[r].separator||"")+a,".."===a||"."===a||"this"===a){if(n.length>0)throw new e("Invalid path: "+i);".."===a?s++:this.isScoped=!0}else n.push(a)}this.original=i,this.parts=n,this.string=n.join("."),this.depth=s,this.isSimple=1===t.length&&!this.isScoped&&0===s,this.stringModeValue=this.string},PartialNameNode:function(t){this.type="PARTIAL_NAME",this.name=t.original},DataNode:function(t){this.type="DATA",this.id=t},StringNode:function(t){this.type="STRING",this.original=this.string=this.stringModeValue=t},IntegerNode:function(t){this.type="INTEGER",this.original=this.integer=t,this.stringModeValue=Number(t)},BooleanNode:function(t){this.type="BOOLEAN",this.bool=t,this.stringModeValue="true"===t},CommentNode:function(t){this.type="comment",this.comment=t}};return i}(i),a=function(){"use strict";return function(){function t(t,e){return{left:"~"===t.charAt(2),right:"~"===e.charAt(0)||"~"===e.charAt(1)}}function e(){this.yy={}}var i={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,inMustache_repetition0:28,inMustache_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,hash:35,hash_repetition_plus0:36,hashSegment:37,ID:38,EQUALS:39,DATA:40,pathSegments:41,SEP:42,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",38:"ID",39:"EQUALS",40:"DATA",42:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[35,1],[37,3],[26,1],[26,1],[26,1],[30,2],[21,1],[41,3],[41,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[36,1],[36,2]],performAction:function(e,i,n,s,r,o){var a=o.length-1;switch(r){case 1:return new s.ProgramNode(o[a-1]);case 2:return new s.ProgramNode([]);case 3:this.$=new s.ProgramNode([],o[a-1],o[a]);break;case 4:this.$=new s.ProgramNode(o[a-2],o[a-1],o[a]);break;case 5:this.$=new s.ProgramNode(o[a-1],o[a],[]);break;case 6:this.$=new s.ProgramNode(o[a]);break;case 7:case 8:this.$=new s.ProgramNode([]);break;case 9:this.$=[o[a]];break;case 10:o[a-1].push(o[a]),this.$=o[a-1];break;case 11:this.$=new s.BlockNode(o[a-2],o[a-1].inverse,o[a-1],o[a]);break;case 12:this.$=new s.BlockNode(o[a-2],o[a-1],o[a-1].inverse,o[a]);break;case 13:case 14:this.$=o[a];break;case 15:this.$=new s.ContentNode(o[a]);break;case 16:this.$=new s.CommentNode(o[a]);break;case 17:case 18:this.$=new s.MustacheNode(o[a-1][0],o[a-1][1],o[a-2],t(o[a-2],o[a]));break;case 19:this.$={path:o[a-1],strip:t(o[a-2],o[a])};break;case 20:case 21:this.$=new s.MustacheNode(o[a-1][0],o[a-1][1],o[a-2],t(o[a-2],o[a]));break;case 22:this.$=new s.PartialNode(o[a-2],o[a-1],t(o[a-3],o[a]));break;case 23:this.$=t(o[a-1],o[a]);break;case 24:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 25:this.$=[[o[a]],null];break;case 26:this.$=o[a];break;case 27:this.$=new s.StringNode(o[a]);break;case 28:this.$=new s.IntegerNode(o[a]);break;case 29:this.$=new s.BooleanNode(o[a]);break;case 30:this.$=o[a];break;case 31:this.$=new s.HashNode(o[a]);break;case 32:this.$=[o[a-2],o[a]];break;case 33:this.$=new s.PartialNameNode(o[a]);break;case 34:this.$=new s.PartialNameNode(new s.StringNode(o[a]));break;case 35:this.$=new s.PartialNameNode(new s.IntegerNode(o[a]));break;case 36:this.$=new s.DataNode(o[a]);break;case 37:this.$=new s.IdNode(o[a]);break;case 38:o[a-2].push({part:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 39:this.$=[{part:o[a]}];break;case 42:this.$=[];break;case 43:o[a-1].push(o[a]);break;case 46:this.$=[o[a]];break;case 47:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:29,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:30,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:31,21:24,30:25,38:[1,28],40:[1,27],41:26},{21:33,26:32,32:[1,34],33:[1,35],38:[1,28],41:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,38:[1,28],40:[1,27],41:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,42],24:[2,42],28:43,32:[2,42],33:[2,42],34:[2,42],38:[2,42],40:[2,42]},{18:[2,25],24:[2,25]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],38:[2,37],40:[2,37],42:[1,44]},{21:45,38:[1,28],41:26},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],40:[2,39],42:[2,39]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,40],21:50,27:49,38:[1,28],41:26},{18:[2,33],38:[2,33]},{18:[2,34],38:[2,34]},{18:[2,35],38:[2,35]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,38:[1,28],41:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,44],21:56,24:[2,44],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:55,36:61,37:62,38:[1,63],40:[1,27],41:26},{38:[1,64]},{18:[2,36],24:[2,36],32:[2,36],33:[2,36],34:[2,36],38:[2,36],40:[2,36]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,65]},{18:[2,41]},{18:[1,66]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24]},{18:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43],40:[2,43]},{18:[2,45],24:[2,45]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],38:[2,26],40:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],38:[2,27],40:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],38:[2,28],40:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],38:[2,29],40:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],38:[2,30],40:[2,30]},{18:[2,31],24:[2,31],37:67,38:[1,68]},{18:[2,46],24:[2,46],38:[2,46]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],39:[1,69],40:[2,39],42:[2,39]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],38:[2,38],40:[2,38],42:[2,38]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{18:[2,47],24:[2,47],38:[2,47]},{39:[1,69]},{21:56,30:60,31:70,32:[1,57],33:[1,58],34:[1,59],38:[1,28],40:[1,27],41:26},{18:[2,32],24:[2,32],38:[2,32]}],defaultActions:{3:[2,2],16:[2,1],50:[2,41]},parseError:function(t){throw new Error(t)},parse:function(t){function e(){var t;return t=i.lexer.lex()||1,"number"!=typeof t&&(t=i.symbols_[t]||t),t}var i=this,n=[0],s=[null],r=[],o=this.table,a="",l=0,c=0,h=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;r.push(u);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,_,b,y,k,w={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:(null!==p&&void 0!==p||(p=e()),g=o[m]&&o[m][p]),void 0===g||!g.length||!g[0]){var T="";if(!h){k=[];for(_ in o[m])this.terminals_[_]&&_>2&&k.push("'"+this.terminals_[_]+"'");T=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(T,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:k})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:n.push(p),s.push(this.lexer.yytext),r.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,u=this.lexer.yylloc,h>0&&h--);break;case 2:if(b=this.productions_[g[1]][1],w.$=s[s.length-b],w._$={first_line:r[r.length-(b||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(b||1)].first_column,last_column:r[r.length-1].last_column},d&&(w._$.range=[r[r.length-(b||1)].range[0],r[r.length-1].range[1]]),void 0!==(v=this.performAction.call(w,a,c,l,this.yy,g[1],s,r)))return v;b&&(n=n.slice(0,-1*b*2),s=s.slice(0,-1*b),r=r.slice(0,-1*b)),n.push(this.productions_[g[1]][0]),s.push(w.$),r.push(w._$),y=o[n[n.length-2]][n[n.length-1]],n.push(y);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,n,s;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),o=0;o<r.length&&(!(i=this._input.match(this.rules[r[o]]))||e&&!(i[0].length>e[0].length)||(e=i,n=o,this.options.flex));o++);return e?(s=e[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,r[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,i){function n(t,i){return e.yytext=e.yytext.substr(t,e.yyleng-i)}switch(i){case 0:if("\\\\"===e.yytext.slice(-2)?(n(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(n(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return n(0,4),this.popState(),15;case 4:return 25;case 5:return 16;case 6:return 20;case 7:case 8:return 19;case 9:return 23;case 10:return 22;case 11:this.popState(),this.begin("com");break;case 12:return n(3,5),this.popState(),15;case 13:return 22;case 14:return 39;case 15:case 16:return 38;case 17:return 42;case 18:break;case 19:return this.popState(),24;case 20:return this.popState(),18;case 21:return e.yytext=n(1,2).replace(/\\"/g,'"'),32;case 22:return e.yytext=n(1,2).replace(/\\'/g,"'"),32;case 23:return 40;case 24:case 25:return 34;case 26:return 33;case 27:return 38;case 28:return e.yytext=n(1,2),38;case 29:return"INVALID";case 30:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s])))/,/^(?:false(?=([~}\s])))/,/^(?:-?[0-9]+(?=([~}\s])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,30],inclusive:!0}},t}();return i.lexer=n,e.prototype=i,i.Parser=e,new e}()}(),l=function(t,e){"use strict";function i(t){return t.constructor===r.ProgramNode?t:(s.yy=r,s.parse(t))}var n={},s=t,r=e;return n.parser=s,n.parse=i,n}(a,o),c=function(t){"use strict";function e(t){this.value=t}function i(){}var n=t.COMPILER_REVISION,s=t.REVISION_CHANGES,r=t.log;i.prototype={nameLookup:function(t,e){var n,s;return 0===t.indexOf("depth")&&(n=!0),s=/^[0-9]+$/.test(e)?t+"["+e+"]":i.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']",n?"("+t+" && "+s+")":s},compilerInfo:function(){var t=n;return"this.compilerInfo = ["+t+",'"+s[t]+"'];\n"},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,i,n){this.environment=t,this.options=e||{},r("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(t,e);var s,o=t.opcodes;this.i=0;for(var a=o.length;this.i<a;this.i++)s=o[this.i],"DECLARE"===s.opcode?this[s.name]=s.value:this[s.opcode].apply(this,s.args),s.opcode!==this.stripNext&&(this.stripNext=!1);return this.pushSource(""),this.createFunctionContext(n)},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,i="helpers = this.merge(helpers, "+e+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+e+".partials);"),this.options.data&&(i+=" data = data || {};"),t.push(i)}this.environment.isSimple?t.push(""):t.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(t){var e=this.stackVars.concat(this.registers.list);if(e.length>0&&(this.source[1]=this.source[1]+", "+e.join(", ")),!this.isChild)for(var i in this.context.aliases)this.context.aliases.hasOwnProperty(i)&&(this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var n=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],s=0,o=this.environment.depths.list.length;s<o;s++)n.push("depth"+this.environment.depths.list[s]);var a=this.mergeSource();if(this.isChild||(a=this.compilerInfo()+a),t)return n.push(a),Function.apply(this,n);var l="function "+(this.name||"")+"("+n.join(",")+") {\n  "+a+"}";return r("debug",l+"\n\n"),l},mergeSource:function(){for(var t,e="",i=0,n=this.source.length;i<n;i++){var s=this.source[i];s.appendToBuffer?t=t?t+"\n    + "+s.content:s.content:(t&&(e+="buffer += "+t+";\n  ",t=undefined),e+=s+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t),this.replaceStack(function(e){return t.splice(1,0,e),"blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e),t[t.length-1]="options",this.pushSource("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.pendingContent&&(t=this.pendingContent+t),this.stripNext&&(t=t.replace(/^\s+/,"")),this.pendingContent=t},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var t=this.popStack();this.pushSource("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){this.lastContext!==t&&(this.lastContext=t)},lookupOnContext:function(t){this.push(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+".apply(depth0) : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(t,e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e),"string"==typeof t?this.pushString(t):this.pushStackLiteral(t)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var t=this.hash;this.hash=undefined,this.options.stringParams&&(this.register("hashContexts","{"+t.contexts.join(",")+"}"),this.register("hashTypes","{"+t.types.join(",")+"}")),this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},invokeHelper:function(t,e){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(t,e,!0),n=this.nameLookup("depth"+this.lastContext,e,"context");this.push(i.name+" || "+n),this.replaceStack(function(t){return t+" ? "+t+".call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(t,e){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var i=this.setupHelper(0,t,e),n=this.lastHelper=this.nameLookup("helpers",t,"helper"),s=this.nameLookup("depth"+this.lastContext,t,"context"),r=this.nextStack();this.pushSource("if ("+r+" = "+n+") { "+r+" = "+r+".call("+i.callParams+"); }"),this.pushSource("else { "+r+" = "+s+"; "+r+" = typeof "+r+" === functionType ? "+r+".call("+i.callParams+") : "+r+"; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];this.options.data&&e.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+e.join(", ")+")")},assignToHash:function(t){var e,i,n=this.popStack();this.options.stringParams&&(i=this.popStack(),e=this.popStack());var s=this.hash;e&&s.contexts.push("'"+t+"': "+e),i&&s.types.push("'"+t+"': "+i),s.values.push("'"+t+"': ("+n+")")},compiler:i,compileChildren:function(t,e){for(var i,n,s=t.children,r=0,o=s.length;r<o;r++){i=s[r],n=new this.compiler;var a=this.matchExistingProgram(i);null==a?(this.context.programs.push(""),a=this.context.programs.length,i.index=a,i.name="program"+a,this.context.programs[a]=n.compile(i,e,this.context),this.context.environments[a]=i):(i.index=a,i.name="program"+a)}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;e<i;e++){var n=this.context.environments[e];if(n&&n.equals(t))return e}},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,i=this.environment.children[t],n=i.depths.list,s=[i.index,i.name,"data"],r=0,o=n.length;r<o;r++)e=n[r],1===e?s.push("depth0"):s.push("depth"+(e-1));return(0===n.length?"self.program(":"self.programWithDepth(")+s.join(", ")+")"},register:function(t,e){this.useRegister(t),this.pushSource(t+" = "+e+";")},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.push(new e(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),t&&this.source.push(t)},pushStack:function(t){this.flushInline();var e=this.incrStack();return t&&this.pushSource(e+" = "+t+";"),this.compileStack.push(e),e},replaceStack:function(t){var i,n="",s=this.isInline();if(s){var r=this.popStack(!0);if(r instanceof e)i=r.value;else{var o=this.stackSlot?this.topStackName():this.incrStack();n="("+this.push(o)+" = "+r+"),",i=this.topStack()}}else i=this.topStack();var a=t.call(this,i);return s?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+n+a+")")):(/^stack/.test(i)||(i=this.nextStack()),this.pushSource(i+" = ("+n+a+");")),i},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var i=0,n=t.length;i<n;i++){var s=t[i];s instanceof e?this.compileStack.push(s):this.pushStack(s)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var i=this.isInline(),n=(i?this.inlineStack:this.compileStack).pop();return!t&&n instanceof e?n.value:(i||this.stackSlot--,n)},topStack:function(t){var i=this.isInline()?this.inlineStack:this.compileStack,n=i[i.length-1];return!t&&n instanceof e?n.value:n},quotedString:function(t){
return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(t,e,i){var n=[];return this.setupParams(t,n,i),{params:n,name:this.nameLookup("helpers",e,"helper"),callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(e)].concat(n).join(", ")}},setupParams:function(t,e,i){var n,s,r,o=[],a=[],l=[];o.push("hash:"+this.popStack()),s=this.popStack(),((r=this.popStack())||s)&&(r||(this.context.aliases.self="this",r="self.noop"),s||(this.context.aliases.self="this",s="self.noop"),o.push("inverse:"+s),o.push("fn:"+r));for(var c=0;c<t;c++)n=this.popStack(),e.push(n),this.options.stringParams&&(l.push(this.popStack()),a.push(this.popStack()));return this.options.stringParams&&(o.push("contexts:["+a.join(",")+"]"),o.push("types:["+l.join(",")+"]"),o.push("hashContexts:hashContexts"),o.push("hashTypes:hashTypes")),this.options.data&&o.push("data:data"),o="{"+o.join(",")+"}",i?(this.register("options",o),e.push("options")):e.push(o),e.join(", ")}};for(var o="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),a=i.RESERVED_WORDS={},l=0,c=o.length;l<c;l++)a[o[l]]=!0;return i.isValidJavaScriptVariableName=function(t){return!(i.RESERVED_WORDS[t]||!/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(t))},i}(n),h=function(t,e,i,n){"use strict";function s(){}function r(t,e){if(null==t||"string"!=typeof t&&t.constructor!==u.ProgramNode)throw new l("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);"data"in(e=e||{})||(e.data=!0);var i=c(t),n=(new s).compile(i,e);return(new h).compile(n,e)}function o(t,e,i){function n(){var n=c(t),r=(new s).compile(n,e),o=(new h).compile(r,e,undefined,!0);return i.template(o)}if(null==t||"string"!=typeof t&&t.constructor!==u.ProgramNode)throw new l("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in(e=e||{})||(e.data=!0);var r;return function(t,e){return r||(r=n()),r.call(this,t,e)}}var a={},l=t,c=e.parse,h=i,u=n;return a.Compiler=s,s.prototype={compiler:s,disassemble:function(){for(var t,e,i,n=this.opcodes,s=[],r=0,o=n.length;r<o;r++)if(t=n[r],"DECLARE"===t.opcode)s.push("DECLARE "+t.name+"="+t.value);else{e=[];for(var a=0;a<t.args.length;a++)i=t.args[a],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),e.push(i);s.push(t.opcode+" "+e.join(" "))}return s.join("\n")},equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var i=0;i<e;i++){var n=this.opcodes[i],s=t.opcodes[i];if(n.opcode!==s.opcode||n.args.length!==s.args.length)return!1;for(var r=0;r<n.args.length;r++)if(n.args[r]!==s.args[r])return!1}if(e=this.children.length,t.children.length!==e)return!1;for(i=0;i<e;i++)if(!this.children[i].equals(t.children[i]))return!1;return!0},guid:0,compile:function(t,e){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=e;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.accept(t)},accept:function(t){var e,i=t.strip||{};return i.left&&this.opcode("strip"),e=this[t.type](t),i.right&&this.opcode("strip"),e},program:function(t){for(var e=t.statements,i=0,n=e.length;i<n;i++)this.accept(e[i]);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,i=(new this.compiler).compile(t,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var s=0,r=i.depths.list.length;s<r;s++)(e=i.depths.list[s])<2||this.addDepth(e-1);return n},block:function(t){var e=t.mustache,i=t.program,n=t.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var s=this.classifyMustache(e);"helper"===s?this.helperMustache(e,i,n):"simple"===s?(this.simpleMustache(e),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(e,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,i,n=t.pairs;this.opcode("pushHash");for(var s=0,r=n.length;s<r;s++)e=n[s],i=e[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type)):this.accept(i),this.opcode("assignToHash",e[0]);this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=!0,t.context?this.ID(t.context):this.opcode("push","depth0"),this.opcode("invokePartial",e.name),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){var e=this.options,i=this.classifyMustache(t);"simple"===i?this.simpleMustache(t):"helper"===i?this.helperMustache(t):this.ambiguousMustache(t),t.escaped&&!e.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(t,e,i){var n=t.id,s=n.parts[0],r=null!=e||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",s,r)},simpleMustache:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),s=t.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",n.length,s);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+s);this.opcode("invokeHelper",n.length,s)}},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth),t.parts[0]?this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");for(var e=1,i=t.parts.length;e<i;e++)this.opcode("lookup",t.parts[e])},DATA:function(t){if(this.options.data=!0,t.id.isScoped||t.id.depth)throw new l("Scoped data references are not supported: "+t.original);this.opcode("lookupData");for(var e=t.id.parts,i=0,n=e.length;i<n;i++)this.opcode("lookup",e[i])},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){if(isNaN(t))throw new Error("EWOT");0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifyMustache:function(t){var e=t.isHelper,i=t.eligibleHelper,n=this.options;if(i&&!e){var s=t.id.parts[0];n.knownHelpers[s]?e=!0:n.knownHelpersOnly&&(i=!1)}return e?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e,i=t.length;i--;)e=t[i],this.options.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.stringModeValue,e.type)):this[e.type](e)},setupMustacheParams:function(t){var e=t.params;return this.pushParams(e),t.hash?this.hash(t.hash):this.opcode("emptyHash"),e},setupFullMustacheParams:function(t,e,i){var n=t.params;return this.pushParams(n),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.hash(t.hash):this.opcode("emptyHash"),n}},a.precompile=r,a.compile=o,a}(i,l,c,o);return function(t,e,i,n,s){"use strict";var r=t,o=e,a=i.parser,l=i.parse,c=n.Compiler,h=n.compile,u=n.precompile,d=s,p=r.create,f=function(){var t=p();return t.compile=function(e,i){return h(e,i,t)},t.precompile=u,t.AST=o,t.Compiler=c,t.JavaScriptCompiler=d,t.Parser=a,t.parse=l,t};return r=f(),r.create=f,r}(r,o,l,h,c)}();(function(){var t=this,e=t._,i={},n=Array.prototype,s=Object.prototype,r=Function.prototype,o=n.push,a=n.slice,l=n.concat,c=s.toString,h=s.hasOwnProperty,u=n.forEach,d=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,_=n.indexOf,b=n.lastIndexOf,y=Array.isArray,k=Object.keys,w=r.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):t._=T,T.VERSION="1.5.2";var C=T.each=T.forEach=function(t,e,n){if(null!=t)if(u&&t.forEach===u)t.forEach(e,n);else if(t.length===+t.length){for(var s=0,r=t.length;s<r;s++)if(e.call(n,t[s],s,t)===i)return}else for(var o=T.keys(t),s=0,r=o.length;s<r;s++)if(e.call(n,t[o[s]],o[s],t)===i)return};T.map=T.collect=function(t,e,i){var n=[];return null==t?n:d&&t.map===d?t.map(e,i):(C(t,function(t,s,r){n.push(e.call(i,t,s,r))}),n)};var E="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return n&&(e=T.bind(e,n)),s?t.reduce(e,i):t.reduce(e);if(C(t,function(t,r,o){s?i=e.call(n,i,t,r,o):(i=t,s=!0)}),!s)throw new TypeError(E);return i},T.reduceRight=T.foldr=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return n&&(e=T.bind(e,n)),s?t.reduceRight(e,i):t.reduceRight(e);var r=t.length;if(r!==+r){var o=T.keys(t);r=o.length}if(C(t,function(a,l,c){l=o?o[--r]:--r,s?i=e.call(n,i,t[l],l,c):(i=t[l],s=!0)}),!s)throw new TypeError(E);return i},T.find=T.detect=function(t,e,i){var n;return S(t,function(t,s,r){if(e.call(i,t,s,r))return n=t,!0}),n},T.filter=T.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(C(t,function(t,s,r){e.call(i,t,s,r)&&n.push(t)}),n)},T.reject=function(t,e,i){return T.filter(t,function(t,n,s){return!e.call(i,t,n,s)},i)},T.every=T.all=function(t,e,n){e||(e=T.identity);var s=!0;return null==t?s:g&&t.every===g?t.every(e,n):(C(t,function(t,r,o){if(!(s=s&&e.call(n,t,r,o)))return i}),!!s)};var S=T.some=T.any=function(t,e,n){e||(e=T.identity);var s=!1;return null==t?s:v&&t.some===v?t.some(e,n):(C(t,function(t,r,o){if(s||(s=e.call(n,t,r,o)))return i}),!!s)};T.contains=T.include=function(t,e){return null!=t&&(_&&t.indexOf===_?-1!=t.indexOf(e):S(t,function(t){return t===e}))},T.invoke=function(t,e){var i=a.call(arguments,2),n=T.isFunction(e);return T.map(t,function(t){return(n?e:t[e]).apply(t,i)})},T.pluck=function(t,e){return T.map(t,function(t){return t[e]})},T.where=function(t,e,i){return T.isEmpty(e)?i?void 0:[]:T[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},T.findWhere=function(t,e){return T.where(t,e,!0)},T.max=function(t,e,i){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&T.isEmpty(t))return-Infinity;var n={computed:-Infinity,value:-Infinity};return C(t,function(t,s,r){var o=e?e.call(i,t,s,r):t;o>n.computed&&(n={value:t,computed:o})}),n.value},T.min=function(t,e,i){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&T.isEmpty(t))return Infinity;var n={computed:Infinity,value:Infinity};return C(t,function(t,s,r){var o=e?e.call(i,t,s,r):t;o<n.computed&&(n={value:t,computed:o})}),n.value},T.shuffle=function(t){var e,i=0,n=[];return C(t,function(t){e=T.random(i++),n[i-1]=n[e],n[e]=t}),n},T.sample=function(t,e,i){return arguments.length<2||i?t[T.random(t.length-1)]:T.shuffle(t).slice(0,Math.max(0,e))};var x=function(t){return T.isFunction(t)?t:function(e){return e[t]}};T.sortBy=function(t,e,i){var n=x(e);return T.pluck(T.map(t,function(t,e,s){return{value:t,index:e,criteria:n.call(i,t,e,s)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var N=function(t){return function(e,i,n){var s={},r=null==i?T.identity:x(i);return C(e,function(i,o){var a=r.call(n,i,o,e);t(s,a,i)}),s}};T.groupBy=N(function(t,e,i){(T.has(t,e)?t[e]:t[e]=[]).push(i)}),T.indexBy=N(function(t,e,i){t[e]=i}),T.countBy=N(function(t,e){T.has(t,e)?t[e]++:t[e]=1}),T.sortedIndex=function(t,e,i,n){i=null==i?T.identity:x(i);for(var s=i.call(n,e),r=0,o=t.length;r<o;){var a=r+o>>>1;i.call(n,t[a])<s?r=a+1:o=a}return r},T.toArray=function(t){return t?T.isArray(t)?a.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:a.call(t,0,e)},T.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},T.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var $=function(t,e,i){return e&&T.every(t,T.isArray)?l.apply(i,t):(C(t,function(t){T.isArray(t)||T.isArguments(t)?e?o.apply(i,t):$(t,e,i):i.push(t)}),i)};T.flatten=function(t,e){return $(t,e,[])},T.without=function(t){return T.difference(t,a.call(arguments,1))},T.uniq=T.unique=function(t,e,i,n){T.isFunction(e)&&(n=i,i=e,e=!1);var s=i?T.map(t,i,n):t,r=[],o=[];return C(s,function(i,n){(e?n&&o[o.length-1]===i:T.contains(o,i))||(o.push(i),r.push(t[n]))}),r},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(t){var e=a.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(e,function(e){return T.indexOf(e,t)>=0})})},T.difference=function(t){var e=l.apply(n,a.call(arguments,1));return T.filter(t,function(t){return!T.contains(e,t)})},T.zip=function(){for(var t=T.max(T.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;i<t;i++)e[i]=T.pluck(arguments,""+i);return e},T.object=function(t,e){if(null==t)return{};for(var i={},n=0,s=t.length;n<s;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},T.indexOf=function(t,e,i){if(null==t)return-1;var n=0,s=t.length;if(i){if("number"!=typeof i)return n=T.sortedIndex(t,e),t[n]===e?n:-1;n=i<0?Math.max(0,s+i):i}if(_&&t.indexOf===_)return t.indexOf(e,i);for(;n<s;n++)if(t[n]===e)return n;return-1},T.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var s=n?i:t.length;s--;)if(t[s]===e)return s;return-1},T.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),s=0,r=new Array(n);s<n;)r[s++]=t,t+=i;return r};var I=function(){};T.bind=function(t,e){var i,n;if(w&&t.bind===w)return w.apply(t,a.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));I.prototype=t.prototype;var s=new I;I.prototype=null;var r=t.apply(s,i.concat(a.call(arguments)));return Object(r)===r?r:s}},T.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},T.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return C(e,function(e){t[e]=T.bind(t[e],t)}),t},T.memoize=function(t,e){var i={};return e||(e=T.identity),function(){var n=e.apply(this,arguments);return T.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},T.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(a.call(arguments,1)))},T.throttle=function(t,e,i){var n,s,r,o=null,a=0;i||(i={});var l=function(){a=!1===i.leading?0:new Date,o=null,r=t.apply(n,s)};return function(){var c=new Date;a||!1!==i.leading||(a=c);var h=e-(c-a);return n=this,s=arguments,h<=0?(clearTimeout(o),o=null,a=c,r=t.apply(n,s)):o||!1===i.trailing||(o=setTimeout(l,h)),r}},T.debounce=function(t,e,i){var n,s,r,o,a;return function(){r=this,s=arguments,o=new Date;var l=function(){var c=new Date-o;c<e?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(r,s)))},c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(r,s)),a}},T.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},T.wrap=function(t,e){return function(){var i=[t];return o.apply(i,arguments),e.apply(this,i)}},T.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},T.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},T.keys=k||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)T.has(t,i)&&e.push(i);return e},T.values=function(t){for(var e=T.keys(t),i=e.length,n=new Array(i),s=0;s<i;s++)n[s]=t[e[s]];return n},T.pairs=function(t){for(var e=T.keys(t),i=e.length,n=new Array(i),s=0;s<i;s++)n[s]=[e[s],t[e[s]]];return n},T.invert=function(t){for(var e={},i=T.keys(t),n=0,s=i.length;n<s;n++)e[t[i[n]]]=i[n];return e},T.functions=T.methods=function(t){var e=[];for(var i in t)T.isFunction(t[i])&&e.push(i);return e.sort()},T.extend=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},T.pick=function(t){var e={},i=l.apply(n,a.call(arguments,1));return C(i,function(i){i in t&&(e[i]=t[i])}),e},T.omit=function(t){var e={},i=l.apply(n,a.call(arguments,1));for(var s in t)T.contains(i,s)||(e[s]=t[s]);return e},T.defaults=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var A=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var s=c.call(t);if(s!=c.call(e))return!1;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=i.length;r--;)if(i[r]==t)return n[r]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(T.isFunction(o)&&o instanceof o&&T.isFunction(a)&&a instanceof a))return!1;i.push(t),n.push(e);var l=0,h=!0;if("[object Array]"==s){if(l=t.length,h=l==e.length)for(;l--&&(h=A(t[l],e[l],i,n)););}else{for(var u in t)if(T.has(t,u)&&(l++,!(h=T.has(e,u)&&A(t[u],e[u],i,n))))break;if(h){for(u in e)if(T.has(e,u)&&!l--)break;h=!l}}return i.pop(),n.pop(),h};T.isEqual=function(t,e){return A(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=y||function(t){return"[object Array]"==c.call(t)},T.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==c.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return h.call(t,e)},T.noConflict=function(){return t._=e,this},T.identity=function(t){return t},T.times=function(t,e,i){for(var n=Array(Math.max(0,t)),s=0;s<t;s++)n[s]=e.call(i,s);return n},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var O={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};O.unescape=T.invert(O.escape);var M={escape:new RegExp("["+T.keys(O.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(O.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(e){return null==e?"":(""+e).replace(M[t],function(e){return O[t][e]})}}),T.result=function(t,e){if(null!=t){var i=t[e];return T.isFunction(i)?i.call(t):i}},T.mixin=function(t){C(T.functions(t),function(e){var i=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),j.call(this,i.apply(T,t))}})};var V=0;T.uniqueId=function(t){var e=++V+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,i){var n;i=T.defaults({},i,T.templateSettings);var s=new RegExp([(i.escape||P).source,(i.interpolate||P).source,(i.evaluate||P).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(s,function(e,i,n,s,a){return o+=t.slice(r,a).replace(R,function(t){return"\\"+D[t]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),r=a+e.length,e}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(t){throw t.source=o,t}if(e)return n(e,T);var a=function(t){return n.call(this,t,T)};return a.source="function("+(i.variable||"obj")+"){\n"+o+"}",a},T.chain=function(t){return T(t).chain()};var j=function(t){return this._chain?T(t).chain():t};T.mixin(T),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];T.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],j.call(this,i)}}),C(["concat","join","slice"],function(t){var e=n[t];T.prototype[t]=function(){return j.call(this,e.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){var t,e=this,i=e.Backbone,n=[],s=(n.push,n.slice);n.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.1.0";var r=e._;r||"undefined"==typeof require||(r=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=t.Events={on:function(t,e,i){return l(this,"on",t,[e,i])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this):this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var n=this,s=r.once(function(){n.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,i)},off:function(t,e,i){var n,s,o,a,c,h,u,d;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:r.keys(this._events),c=0,h=a.length;c<h;c++)if(t=a[c],o=this._events[t]){if(this._events[t]=n=[],e||i)for(u=0,d=o.length;u<d;u++)s=o[u],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&n.push(s);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var o in n)t=n[o],t.off(e,i,this),(s||r.isEmpty(t._events))&&delete this._listeningTo[o];return this}},a=/\s+/,l=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(n));return!1}if(a.test(i)){for(var r=i.split(a),o=0,l=r.length;o<l;o++)t[e].apply(t,[r[o]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o,a);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};r.each(h,function(t,e){o[e]=function(e,i,n){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=r.uniqueId("l"))]=e,n||"object"!=typeof i||(n=this),e[t](i,n,this),this}}),o.bind=o.on,o.unbind=o.off,r.extend(t,o);var u=t.Model=function(t,e){var i=t||{};e||(e={}),this.cid=r.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=r.defaults({},i,r.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};r.extend(u.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return r.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,s,o,a,l,c,h,u;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;o=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=r.clone(this.attributes),this.changed={}),u=this.attributes,h=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(n in s)e=s[n],r.isEqual(u[n],e)||a.push(n),r.isEqual(h[n],e)?delete this.changed[n]:this.changed[n]=e,o?delete u[n]:u[n]=e;if(!l){a.length&&(this._pending=!0);for(var d=0,p=a.length;d<p;d++)this.trigger("change:"+a[d],this,u[a[d]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,r.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,r.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!r.isEmpty(this.changed):r.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&r.clone(this.changed);var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var s in t)r.isEqual(n[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){if(!e.set(e.parse(n,t),t))return!1;i&&i(e,n,t),e.trigger("sync",e,n,t)},D(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,s,o,a=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=r.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=r.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(t){l.attributes=a;var e=l.parse(t,i);if(i.wait&&(e=r.extend(n||{},e)),r.isObject(e)&&!l.set(e,i))return!1;c&&c(l,t,i),l.trigger("sync",l,t,i)},D(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=n),o=this.sync(s,this,i),n&&i.wait&&(this.attributes=a),o},destroy:function(t){t=t?r.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(s){(t.wait||e.isNew())&&n(),i&&i(e,s,t),e.isNew()||e.trigger("sync",e,s,t)},this.isNew())return t.success(),!1;D(this,t);var s=this.sync("delete",this,t);return t.wait||n(),s},url:function(){var t=r.result(this,"urlRoot")||r.result(this.collection,"url")||P();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},r.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=r.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,r.extend(e,{validationError:i})),!1)}});var d=["keys","values","pairs","invert","pick","omit"];r.each(d,function(t){u.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.attributes),r[t].apply(r,e)}});var p=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,r.extend({silent:!0},e))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};r.extend(p.prototype,o,{model:u,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,r.extend({merge:!1},e,m))},remove:function(t,e){var i=!r.isArray(t);t=i?[t]:r.clone(t),e||(e={});var n,s,o,a;for(n=0,s=t.length;n<s;n++)(a=t[n]=this.get(t[n]))&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a));return i?t[0]:t},set:function(t,e){e=r.defaults({},e,f),e.parse&&(t=this.parse(t,e));var i=!r.isArray(t);t=i?t?[t]:[]:r.clone(t);var n,s,o,a,l,c,h,d=e.at,p=this.model,m=this.comparator&&null==d&&!1!==e.sort,g=r.isString(this.comparator)?this.comparator:null,v=[],_=[],b={},y=e.add,k=e.merge,w=e.remove,T=!(m||!y||!w)&&[];for(n=0,s=t.length;n<s;n++){if(l=t[n],o=l instanceof u?a=l:l[p.prototype.idAttribute],c=this.get(o))w&&(b[c.cid]=!0),k&&(l=l===a?a.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e),m&&!h&&c.hasChanged(g)&&(h=!0)),t[n]=c;else if(y){if(!(a=t[n]=this._prepareModel(l,e)))continue;v.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}T&&T.push(c||a)}if(w){for(n=0,s=this.length;n<s;++n)b[(a=this.models[n]).cid]||_.push(a);_.length&&this.remove(_,e)}if(v.length||T&&T.length)if(m&&(h=!0),this.length+=v.length,null!=d)for(n=0,s=v.length;n<s;n++)this.models.splice(d+n,0,v[n]);else{T&&(this.models.length=0);var C=T||v;for(n=0,s=C.length;n<s;n++)this.models.push(C[n])}if(h&&this.sort({silent:!0}),!e.silent){for(n=0,s=v.length;n<s;n++)(a=v[n]).trigger("add",a,this,e);(h||T&&T.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,r.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,r.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,r.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return r.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return r.invoke(this.models,"get",t)},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var s=t.reset?"reset":"set";i[s](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},D(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?r.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(t,e,s){s.wait&&i.add(t,s),n&&n(t,e,s)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof u)return t.collection||(t.collection=this),t;e=e?r.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeReference:function(t){
this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(g,function(t){p.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.models),r[t].apply(r,e)}});var v=["groupBy","countBy","sortBy"];r.each(v,function(t){p.prototype[t]=function(e,i){var n=r.isFunction(e)?e:function(t){return t.get(e)};return r[t](this.models,n,i)}});var _=t.View=function(t){this.cid=r.uniqueId("view"),t||(t={}),r.extend(this,r.pick(t,y)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,y=["model","collection","el","id","attributes","className","tagName","events"];r.extend(_.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=r.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(r.isFunction(i)||(i=this[t[e]]),i){var n=e.match(b),s=n[1],o=n[2];i=r.bind(i,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,i):this.$el.on(s,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"),!1);else{var e=r.extend({},r.result(this,"attributes"));this.id&&(e.id=r.result(this,"id")),this.className&&(e["class"]=r.result(this,"className"));var i=t.$("<"+r.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var s=w[e];r.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(n.url||(o.url=r.result(i,"url")||P()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",n.emulateJSON&&(o.data._method=s);var a=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",s),a)return a.apply(this,arguments)}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"===o.type&&k&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(r.extend(o,n));return i.trigger("request",i,l,n),l};var k=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var T=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,S=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(T.prototype,o,{initialize:function(){},route:function(e,i,n){r.isRegExp(e)||(e=this._routeToRegExp(e)),r.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var s=this;return t.history.route(e,function(r){var o=s._extractParameters(e,r);n&&n.apply(s,o),s.trigger.apply(s,["route:"+i].concat(o)),s.trigger("route",i,o),t.history.trigger("route",s,i,o)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var t,e=r.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(x,"\\$&").replace(C,"(?:$1)?").replace(E,function(t,e){return e?t:"([^/]+)"}).replace(S,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return r.map(i,function(t){return t?decodeURIComponent(t):null})}});var N=t.History=function(){this.handlers=[],r.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,A=/msie [\w.]+/,O=/\/$/,M=/[?#].*$/;N.started=!1,r.extend(N.prototype,o,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(O,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace($,"")},start:function(e){if(N.started)throw new Error("Backbone.history has already been started");N.started=!0,this.options=r.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,s=A.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(I,"/"),s&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),N.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),r.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(t,e){if(!N.started)return!1;e&&!0!==e||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(M,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new N;var V=function(t,e){var i,n=this;i=t&&r.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},r.extend(i,n,e);var s=function(){this.constructor=i};return s.prototype=n.prototype,i.prototype=new s,t&&r.extend(i.prototype,t),i.__super__=n.prototype,i};u.extend=p.extend=T.extend=_.extend=N.extend=V;var P=function(){throw new Error('A "url" property or function must be specified')},D=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}}}.call(this),function(){var t={},e=null,i=null,n=document.title,s=null,r=null,o={},a=window.devicePixelRatio||1,l=16*a,c={width:7,height:9,font:10*a+"px arial",colour:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},h=function(){var t=navigator.userAgent.toLowerCase();return function(e){return-1!==t.indexOf(e)}}(),u={ie:h("msie"),chrome:h("chrome"),webkit:h("chrome")||h("safari"),safari:h("safari")&&!h("chrome"),mozilla:h("mozilla")&&!h("chrome")&&!h("safari")},d=function(){for(var t=document.getElementsByTagName("link"),e=0,i=t.length;e<i;e++)if((t[e].getAttribute("rel")||"").match(/\bicon\b/))return t[e];return!1},p=function(){for(var t=document.getElementsByTagName("link"),e=document.getElementsByTagName("head")[0],i=0,n=t.length;i<n;i++){"undefined"!=typeof t[i]&&(t[i].getAttribute("rel")||"").match(/\bicon\b/)&&e.removeChild(t[i])}},f=function(){if(!i||!e){var t=d();i=e=t?t.getAttribute("href"):"/favicon.ico"}return e},m=function(){return r||(r=document.createElement("canvas"),r.width=l,r.height=l),r},g=function(t){p();var e=document.createElement("link");e.type="image/x-icon",e.rel="icon",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)},v=function(t,e){if(!m().getContext||u.ie||u.safari||"force"===o.fallback)return _(t);var i=m().getContext("2d"),e=e||"#000000",n=f();s=document.createElement("img"),s.onload=function(){i.clearRect(0,0,l,l),i.drawImage(s,0,0,s.width,s.height,0,0,l,l),(t+"").length>0&&b(i,t,e),y()},!n.match(/^data/)&&o.crossOrigin&&(s.crossOrigin="anonymous"),s.src=n},_=function(t){o.fallback&&((t+"").length>0?document.title="("+t+") "+n:document.title=n)},b=function(t,e){"number"==typeof e&&e>99&&o.abbreviate&&(e=k(e));var i=(e+"").length-1,n=o.width*a+6*a*i,s=o.height*a,r=l-s,c=l-n-a,h=16*a,d=16*a,p=2*a;t.font=(u.webkit?"bold ":"")+o.font,t.fillStyle=o.background,t.strokeStyle=o.background,t.lineWidth=a,t.beginPath(),t.moveTo(c+p,r),t.quadraticCurveTo(c,r,c,r+p),t.lineTo(c,h-p),t.quadraticCurveTo(c,h,c+p,h),t.lineTo(d-p,h),t.quadraticCurveTo(d,h,d,h-p),t.lineTo(d,r+p),t.quadraticCurveTo(d,r,d-p,r),t.closePath(),t.fill(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.3)",t.moveTo(c+p/2,h),t.lineTo(d-p/2,h),t.stroke(),t.fillStyle=o.colour,t.textAlign="right",t.textBaseline="top",t.fillText(e,2===a?29:15,u.mozilla?7*a:6*a)},y=function(){m().getContext&&g(m().toDataURL())},k=function(t){for(var e=[["G",1e9],["M",1e6],["k",1e3]],i=0;i<e.length;++i)if(t>=e[i][1]){t=w(t/e[i][1])+e[i][0];break}return t},w=function(t,e){return new Number(t).toFixed(e)};t.setOptions=function(t){o={};for(var e in c)o[e]=t.hasOwnProperty(e)?t[e]:c[e];return this},t.setImage=function(t){return e=t,y(),this},t.setBubble=function(t,e){return t=t||"",v(t,e),this},t.reset=function(){g(i)},t.setOptions(c),window.Tinycon=t}(),function(t){function e(e,i){var n;return t.Notification?n=new t.Notification(e,{icon:_(i.icon)?i.icon:i.icon.x32,body:i.body||f,tag:i.tag||f}):t.webkitNotifications?(n=t.webkitNotifications.createNotification(i.icon,e,i.body),n.show()):navigator.mozNotification?(n=navigator.mozNotification.createNotification(e,i.body,i.icon),n.show()):t.external&&t.external.msIsSiteMode()&&(t.external.msSiteModeClearIconOverlay(),t.external.msSiteModeSetIconOverlay(_(i.icon)?i.icon:i.icon.x16,e),t.external.msSiteModeActivate(),n={ieVerification:g+1}),n}function i(e){return{close:function(){e&&(e.close?e.close():t.external&&t.external.msIsSiteMode()&&e.ieVerification===g&&t.external.msSiteModeClearIconOverlay())}}}function n(e){if(m){var i=v(e)?e:k;t.webkitNotifications&&t.webkitNotifications.checkPermission?t.webkitNotifications.requestPermission(i):t.Notification&&t.Notification.requestPermission&&t.Notification.requestPermission(i)}}function s(){var e;if(m)return t.Notification&&t.Notification.permissionLevel?e=t.Notification.permissionLevel():t.webkitNotifications&&t.webkitNotifications.checkPermission?e=u[t.webkitNotifications.checkPermission()]:navigator.mozNotification?e=c:t.Notification&&t.Notification.permission?e=t.Notification.permission:t.external&&t.external.msIsSiteMode()!==undefined&&(e=t.external.msIsSiteMode()?c:l),e}function r(t){return t&&b(t)&&y(w,t),w}function o(){return!w.pageVisibility||(document.hidden||document.msHidden||document.mozHidden||document.webkitHidden)}function a(n,r){var a,l;return m&&o()&&_(n)&&r&&(_(r.icon)||b(r.icon))&&s()===c&&(a=e(n,r)),l=i(a),w.autoClose&&a&&!a.ieVerification&&a.addEventListener&&a.addEventListener("show",function(){var e=l;t.setTimeout(function(){e.close()},w.autoClose)}),l}var l="default",c="granted",h="denied",u=[c,l,h],d={pageVisibility:!1,autoClose:0},p={},f="",m=function(){var e=!1;try{e=!!(t.Notification||t.webkitNotifications||navigator.mozNotification||t.external&&t.external.msIsSiteMode()!==undefined)}catch(t){}return e}(),g=Math.floor(10*Math.random()+1),v=function(t){return t&&t.constructor===Function},_=function(t){return t&&t.constructor===String},b=function(t){return t&&t.constructor===Object},y=function(t,e){var i,n;for(i in e)n=e[i],i in t&&(t[i]===n||i in p&&p[i]===n)||(t[i]=n);return t},k=function(){},w=d;t.notify={PERMISSION_DEFAULT:l,PERMISSION_GRANTED:c,PERMISSION_DENIED:h,isSupported:m,config:r,createNotification:a,permissionLevel:s,requestPermission:n},v(Object.seal)&&Object.seal(t.notify)}(window);var Talkio={Classes:{},Models:{Stats:{}},Collections:{},Views:{Widgets:{}},Routers:{},Variables:{Stats:{},Widgets:{}},Paths:{},Templates:{}};$('script[type="text/x-handlebars-template"]').each(function(){var t=$(this);Talkio.Templates[t.attr("id").replace("-template","").replace("-","_")]=Handlebars.compile(t.html())}),Talkio.Classes.AsidePanel=Backbone.View.extend({hide:function(){this.$el.removeClass("show")},toggle:function(){this.$el.hasClass("show")?(this.onHide(),$(document).off("click",_.bind(this.hideOnBlur,this))):(this.onShow(),$(document).on("click",_.bind(this.hideOnBlur,this))),this.$el.toggleClass("show")},hideOnBlur:function(t){0==this.$el.find(t.target).length&&(this.$el.removeClass("show"),$(document).off(t))},onShow:function(){},onHide:function(){}}),Talkio.Models.Channel=Backbone.Model.extend({idAttribute:"permalink"}),Talkio.Models.ChannelSettings=Backbone.Model.extend({urlRoot:"/api/chats",historyTTL:function(){return this.get("history_ttl")},isAllowed:function(t){return this.get("allow_anonymous")||!t.isAnonymous()},allowAnonymous:function(){return this.get("allow_anonymous")},toggleAllowAnonymous:function(){this.set("allow_anonymous",!this.get("allow_anonymous")),this.save()},toJSON:function(){return{chat:_.clone(this.attributes)}}}),Talkio.Models.CurrentUser=Backbone.Model.extend({idAttribute:"token",urlRoot:function(){return Talkio.Paths.participant},_typing:!1,owner:!1,inactive_since:null,initialize:function(){this.listenTo(Talkio.Variables.channel_settings,"change:allow_anonymous",this.checkIfAllowed),this.on("sync",this.signIn,this)},join:function(){Talkio.Variables.socket.publishPrivateMessage("join",{token:this.id})},authenticate:function(){console.log("authenticate user"),Talkio.Variables.socket.publishPrivateMessage("authenticate",{token:this.id}),this.trigger("currentUserChanged")},deauthenticate:function(){Talkio.Variables.socket.publishPrivateMessage("deauthenticate"),this.trigger("currentUserChanged")},isSignedIn:function(){return!this.isNew()&&Talkio.Variables.channel_settings.isAllowed(this)},signIn:function(){console.log("signIn user"),Talkio.Variables.socket.connect(),this.authenticate()},signOut:function(){Talkio.Variables.chat_room.is_iframe&&Talkio.Variables.socket.connectAJAX(),this.clear(),this.deauthenticate()},checkIfAllowed:function(){Talkio.Variables.channel_settings.isAllowed(this)?this.authenticate():this.deauthenticate()},setTyping:function(){this._typing||(this._typing=!0,Talkio.Variables.socket.publishPrivateMessage("user_is_typing"))},setCancelledTyping:function(){this._typing&&(this._typing=!1,Talkio.Variables.socket.publishPrivateMessage("user_cancelled_typing"))},makeOwner:function(){this.owner||(this.owner=!0,Talkio.Variables.owned_channels.add({permalink:Talkio.Variables.permalink}),this.trigger("ownership_changed"))},resignOwner:function(){this.owner&&(this.owner=!1,Talkio.Variables.owned_channels.remove(Talkio.Variables.permalink),this.trigger("ownership_changed"))},isOwner:function(){return this.owner},isAnonymous:function(){return"anonymous"==this.get("provider")},placeholder:function(){return this.get("nickname")+"..."}}),Talkio.Models.Message=Backbone.Model.extend({defaults:{expired:!1},urlRoot:function(){return Talkio.Paths.messages},justAdded:function(){return this.get("just_added")},author:function(){return{id:this.get("user_token"),nickname:this.get("nickname"),timestamp:this.get("timestamp"),user:this.get("user"),initials:this.get("nickname")[0],profile_url:this.get("user")&&this.get("user").profile_url}},"delete":function(){$.post(this.url(),{_method:"DELETE"},_.bind(function(){window.ga("send","event","messages","deleted",this.id)},this))},isDeleted:function(){return this.get("deleted")},markAsDeleted:function(t){this.set("body",t),this.set("deleted",!0)},hasExpired:function(t){return new Date-this.createdAt()>1e3*t},markAsExpired:function(){this.set("expired",!0)},plainBody:function(){return $("<div />").html(this.get("body")).text()},createdAt:function(){return new Date(1e3*this.get("timestamp"))},isReadByCurrentUser:function(){return!Talkio.Variables.chat_room.getInactivityTimestamp()||Talkio.Variables.chat_room.getInactivityTimestamp()>this.get("timestamp")},canBeDeletedBy:function(t){return Talkio.Variables.current_user.isOwner()||this.get("user_token")==t.id},processedBody:function(){var t=this.get("body"),e=[[/(^|\s)@([a-zA-Z0-9_\-]+)/gi,'$1<a href="#" class="reply" data-reply-to="$2">@$2</a>'],[/(^|\s)@\/([^\/]+)\//gi,'$1<a href="#" class="reply" data-reply-to="$2">@$2</a>'],[/(^|\s)#([a-zA-Z0-9_-]+)/gi,'$1<a href="/$2" target="_blank">#$2</a>'],[/(^|\s):\-?\)($|\s)/g,'$1<i data-smiley="happy"></i>$2'],[/(^|\s):\-?D($|\s)/g,'$1<i data-smiley="laugh"></i>$2'],[/(^|\s):\-?\(($|\s)/g,'$1<i data-smiley="unhappy"></i>$2'],[/(^|\s):\-?\@($|\s)/g,'$1<i data-smiley="angry"></i>$2'],[/(^|\s):&#39;\-?\(($|\s)/g,'$1<i data-smiley="cry"></i>$2'],[/(^|\s):\-?\o($|\s)/gi,'$1<i data-smiley="surprised"></i>$2'],[/(^|\s);\-?\)($|\s)/g,'$1<i data-smiley="wink"></i>$2'],[/(^|\s):\-?\p($|\s)/gi,'$1<i data-smiley="tongue"></i>$2'],[/(^|\s):\-?\/($|\s)/g,'$1<i data-smiley="displeased"></i>$2'],[/(^|\s):\-?\|($|\s)/g,'$1<i data-smiley="sleep"></i>$2'],[/(^|\s)(0|o):\-?\)($|\s)/gi,'$1<i data-smiley="saint"></i>$3'],[/(^|\s)\}:\-?\)($|\s)/gi,'$1<i data-smiley="devil"></i>$2'],[/(^|\s)\(y\)($|\s)/gi,'$1<i data-smiley="thumbsup"></i>$2']];return _.each(e,function(e){t=t.replace(e[0],e[1])}),t}}),Talkio.Models.Statistics=Backbone.Model.extend({defaults:{non_empty_room_count:0,twitter_user_count:0,non_twitter_user_count:0,total_user_count:0,last_minute_rate:98},loggedInCount:function(){return this.get("twitter_user_count")+this.get("non_twitter_user_count")},guestsCount:function(){return this.get("total_user_count")-this.loggedInCount()}}),Talkio.Models.User=Backbone.Model.extend({idAttribute:"token",owner:!1,setTyping:function(){this.set("is_typing",!0)},setCancelledTyping:function(){this.set("is_typing",!1)},isAnonymous:function(){return"anonymous"==this.get("provider")},ban:function(){this.set("banned",!0)},unban:function(){this.set("banned",!1)},isBanned:function(){return this.get("banned")},isMuted:function(){return _.include(Talkio.Variables.muted_user_ids,this.id)},isTyping:function(){return this.get("is_typing")},isCurrentUser:function(){return this.id==Talkio.Variables.current_user.id},placeholder:function(){return this.get("nickname")+"..."},profileURL:function(){return this.get("profile_url")},biggerAvatar:function(){return this.get("avatar").replace("_normal.","_bigger.")}}),Talkio.Models.UserSettings=Backbone.Model.extend({defaults:{sound_enabled:!1,notifications_enabled:!1,notifications_supported:!1,current_theme:"theme--day",previous_theme:null},_persisted_settings:["sound_enabled","notifications_enabled","current_theme"],_storage_key:"tlkio.user_settings",initialize:function(){this.readSettings(),Talkio.Variables.theme.length&&this.set("current_theme",Talkio.Variables.theme),this.listenTo(this,_.map(this._persisted_settings,function(t){return"change:"+t}).join(" "),this.writeSettings),window.notify.isSupported&&(this.set("notifications_supported",!0),this.get("notifications_enabled")&&this.set("notifications_enabled","granted"==window.notify.permissionLevel()))},readSettings:function(){if(this._checkLocalStorge()){var t=window.localStorage[this._storage_key];_.isString(t)&&_.each(_.pick(JSON.parse(t),this._persisted_settings),function(t,e){this.set(e,t)},this)}},writeSettings:function(){if(this._checkLocalStorge()){var t={};_.each(this._persisted_settings,function(e){t[e]=this.get(e)},this),window.localStorage[this._storage_key]=JSON.stringify(t)}},toggleSound:function(){this.isSoundEnabled()?this.set("sound_enabled",!1):(this.set("sound_enabled",!0),Talkio.Variables.chat_room.playSound())},toggleNotifications:function(){this.get("notifications_enabled")?this.set("notifications_enabled",!1):window.notify.requestPermission(_.bind(function(){"granted"==window.notify.permissionLevel()&&(this.set("notifications_enabled",!0),Talkio.Variables.chat_room.displayNotification("Notifications are enabled",""))},this))},setTheme:function(t){this.get("current_theme")!=t&&(this.set("previous_theme",this.get("current_theme")),this.set("current_theme",t))},isSoundEnabled:function(){return this.get("sound_enabled")},areNotificationsSupported:function(){return this.get("notifications_supported")},areNotificationsEnabled:function(){return this.get("notifications_supported")&&this.get("notifications_enabled")},_checkLocalStorge:function(){return!Modernizr.localstorage&&window.console&&window.console.error("LocalStorage is not available"),Modernizr.localstorage}}),Talkio.Collections.Channels=Backbone.Collection.extend({model:Talkio.Models.Channel}),Talkio.Collections.Messages=Backbone.Collection.extend({model:Talkio.Models.Message,url:function(){return Talkio.Paths.messages},loadEarlierMessages:function(){this.fetch({add:!0,remove:!1,silent:!0,at:0,data:{before_id:this.first()&&this.first().id},success:_.bind(function(t,e){this.trigger("earlier_messages_loaded",{count:e.length})},this)})},loadNewMessages:function(){this.fetch({add:!0,remove:!1,data:{after_id:this.last()&&this.last().id},success:function(){Talkio.Variables.connectionIndicator.setStatus("online")},error:function(){Talkio.Variables.connectionIndicator.setStatus("error")}})},nonExpired:function(){return this.where({expired:!1})},deleteOwnMessages:function(){Talkio.Variables.current_user.isSignedIn()&&$.post(this.url()+"/delete_all",function(){window.ga("send","event","messages","deleted","own")})},deleteAllMessages:function(){Talkio.Variables.current_user.isSignedIn()&&Talkio.Variables.current_user.isOwner()&&$.ajax(Talkio.Paths.chat,{type:"DELETE"},function(){window.ga("send","event","messages","deleted","all")})},markAsDeleted:function(t,e){var i=this.get(t);i&&i.markAsDeleted(e)},markAsDeletedForUser:function(t,e){var i=this.filter(function(e){return e.get("user_token")==t});_.each(i,function(t){t.markAsDeleted(e)}),this.trigger("messages_deleted",t)}}),Talkio.Collections.Owners=Backbone.Collection.extend({model:Talkio.Models.User,initialize:function(){}}),Talkio.Collections.Users=Backbone.Collection.extend({model:Talkio.Models.User,current_user:null,current_user_id:null,initialize:function(){},isCurrentUser:function(t){return t==Talkio.Variables.current_user.id},muted:function(){return this.filter(function(t){return t.isMuted()})},banned:function(){return this.filter(function(t){return t.isBanned()})},addUserWithData:function(t,e){t&&!this.get(t.token)&&this.add(t,e)},removeUser:function(t){var e=this.get(t);this.remove(e)}}),Talkio.Views.AdminSettings=Talkio.Classes.AsidePanel.extend({template:Talkio.Templates.admin_settings,el:"#admin-settings",events:{"click #become-owner":"becomeOwner","click #resign-ownership":"resignOwnership","click #allow-anonymous":"toggleAllowAnonymous"},owners_list:null,remove_my_messages_button:null,remove_all_messages_button:null,_resign_button_pressed:!1,_messages_removed:!1,initialize:function(){this.listenTo(this.model,"ownership_changed",this.render),this.listenTo(Talkio.Variables.channel_settings,"change:allow_anonymous",this.renderAllowAnonymous)},render:function(){return options={},options.permalink=Talkio.Variables.permalink,options.is_hero=!this.model.isAnonymous(),options.is_owner=this.model.isOwner(),options.is_logged_in=this.model.isSignedIn(),options.has_owner=Talkio.Variables.owners.length>0,this.$el.html(this.template(options)),this.owners_list=new Talkio.Views.OwnersList({collection:Talkio.Variables.owners}).render(),delete this.remove_my_messages_button,delete this.remove_all_messages_button,this.model.isSignedIn()&&(this.remove_my_messages_button=new Talkio.Views.RemoveMessagesButton({el:"#remove-my-messages",label:"Delete my messages",confirmation_label:"Yes, remove all my messages from this channel!",remove_function:function(){Talkio.Variables.messages.deleteOwnMessages()}}).render(),this.model.isOwner()&&(this.remove_all_messages_button=new Talkio.Views.RemoveMessagesButton({el:"#remove-all-messages",label:"Delete all messages",confirmation_label:"Yes, remove all messages from this channel!",remove_function:function(){Talkio.Variables.messages.deleteAllMessages()}}).render(),this.renderAllowAnonymous())),this},renderAllowAnonymous:function(){Talkio.Variables.channel_settings.allowAnonymous()?this.$("#allow-anonymous").addClass("isOn"):this.$("#allow-anonymous").removeClass("isOn")},enableRemoveButtons:function(){this.remove_my_messages_button&&this.remove_my_messages_button.enable(),this.remove_all_messages_button&&this.remove_all_messages_button.enable()},becomeOwner:function(){$.post(Talkio.Paths.ownership,_.bind(function(t){t.errors?alert(t.errors[0]):(this.model.makeOwner(),window.ga("send","event","moderator","added",this.model.id))},this),"JSON")},resignOwnership:function(){this._resign_button_pressed?this.checkChannelConfirmation()&&$.post(Talkio.Paths.ownership,{_method:"DELETE"},_.bind(function(){this.hideConfirmation(),this.model.resignOwner(),window.ga("send","event","moderator","removed",this.model.id)},this),"JSON"):this.showConfirmation()},toggleAllowAnonymous:function(){Talkio.Variables.channel_settings.toggleAllowAnonymous()},checkChannelConfirmation:function(){var t=this.$("#channel-confirmation").val();return t.length>0&&t==Talkio.Variables.permalink},showConfirmation:function(){this.$("div.owner-confirm").removeClass("isHidden"),this._resign_button_pressed=!0},hideConfirmation:function(){this._resign_button_pressed=!1,this.$("div.owner-confirm").addClass("isHidden")},checkBecomeOwnerButton:function(){Talkio.Variables.messages.nonExpired().length>0?this.$("#become-owner").hide():this.$("#become-owner").show()},onShow:function(){this.hideConfirmation(),this.checkBecomeOwnerButton()}}),Talkio.Views.OwnersList=Backbone.View.extend({el:"#owners-list",initialize:function(){this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this)},render:function(){return this.$el.html(""),this.collection.each(function(t){this.$el.append(Talkio.Templates.owner(t.attributes))},this),this}}),Talkio.Views.RemoveMessagesButton=Backbone.View.extend({events:{click:"removeMessages"},was_already_clicked:!1,label:null,confirmation_label:null,remove_function:null,initialize:function(t){t&&(this.label=t.label,this.confirmation_label=t.confirmation_label,this.remove_function=t.remove_function)},render:function(){return this.was_already_clicked?this.$el.html(this.confirmation_label):this.$el.html(this.label),this},removeMessages:function(t){t.preventDefault(),this.was_already_clicked?(this.remove_function&&this.remove_function.call(),this.was_already_clicked=!1,this.$el.addClass("disabled")):(this.was_already_clicked=!0,setTimeout(_.bind(this.reset,this),4e3)),this.render()},reset:function(){this.was_already_clicked&&(this.was_already_clicked=!1,this.render())},enable:function(){this.$el.removeClass("disabled"),this.messages_removed=!1}}),Talkio.Views.Aside=Backbone.View.extend({el:"aside",events:{"click #admin-button":"toggleAdminSettings","click #user-button":"toggleUserSettings","click #share_button":"showShare"},previous_theme:null,current_theme:"theme--day",share_view:null,user_settings:null,admin_settings:null,initialize:function(){this.listenTo(Talkio.Variables.current_user,"currentUserChanged",this.configureUserButton),this.listenTo(Talkio.Variables.messages,"add",this.enableRemoveButtons),this.admin_settings=new Talkio.Views.AdminSettings({model:Talkio.Variables.current_user}).render(),this.user_settings=new Talkio.Views.UserSettings({model:Talkio.Variables.user_settings}).render(),this.share_view=(new Talkio.Views.ShareView).render(),Talkio.Variables.online_users=new Talkio.Views.OnlineUsers({collection:this.collection}),Talkio.Variables.user_counter=new Talkio.Views.UserCounter({collection:this.collection,elements:["#user-counter","#panel-counter"]}).render()},render:function(){return this.configureUserButton(),this},configureUserButton:function(){var t=this.$("#user-button").removeClass("isTroll isHero").removeAttr("style");Talkio.Variables.current_user.isSignedIn()&&(Talkio.Variables.current_user.isAnonymous()?t.addClass("isTroll"):t.addClass("isHero").attr("style","background-image: url("+Talkio.Variables.current_user.get("avatar")+");"))},showShare:function(){this.share_view.show()},enableRemoveButtons:function(){this.admin_settings.enableRemoveButtons()},toggleAdminSettings:function(t){t.preventDefault(),t.stopPropagation(),this.user_settings.hide(),this.admin_settings.toggle()},toggleUserSettings:function(t){t.preventDefault(),t.stopPropagation(),this.admin_settings.hide(),this.user_settings.toggle()},setConnected:function(){this.$el.removeClass("not-connected")}}),Talkio.Views.ShareView=Backbone.View.extend({tagName:"section",className:"popup hide",events:{"click #popup-close":"hide",click:"checkHide"},zclip_initialized:!1,render:function(){return this.$el.html(Talkio.Templates.share()).appendTo("body"),this},show:function(){this.$el.removeClass("hide"),this.zclip_initialized?this.$(".url_button").zclip("show"):(this.$(".url_button").zclip({path:"/ZeroClipboard.swf",copy:window.location.href}),this.zclip_initialized=!0)},hide:function(){this.$el.addClass("hide"),this.$(".url_button").zclip("hide")},checkHide:function(t){t.target==this.el&&this.hide()},doNothing:function(t){t.preventDefault(),t.stopPropagation()},clickedLink:function(t){t.stopPropagation()}}),Talkio.Views.MutedUsers=Backbone.View.extend({el:"#ban-list",initialize:function(){Talkio.Variables.muted_user_ids=[],Cookies.get("ban_list")&&(Talkio.Variables.muted_user_ids=_.map(Cookies.get("ban_list").split(","),function(t){return t})),this.collection.on("addMutedUser",this.render,this),this.collection.on("removeMutedUser",this.render,this)},render:function(){var t=_.map(this.collection.muted(),function(t){return".author_"+t.id+" { display: none; }"});return this.$el.text(t.join("\n")),this}}),Talkio.Views.ChatRoom=Backbone.View.extend({el:"body",events:{"click #scroll_down":"scrollToBottom","click #panel-button":"togglePanel"},window_is_inactive:!1,inactive_since:null,inactive_messages:0,remove_unread_timeout:null,scroll_timeout:null,view_at_the_bottom:!0,is_iframe:!1,is_offline:!1,has_cookie_access:!1,sound:document.getElementById("audio_new"),initialize:function(){window!=window.top&&(this.is_iframe=!0),Modernizr.touchevents||$("html").addClass("no-touch"),Talkio.Variables.current_user.on("currentUserChanged",this.changeBodyClass,this),Talkio.Variables.user_settings=new Talkio.Models.UserSettings,Talkio.Variables.messages=new Talkio.Collections.Messages,Talkio.Variables.muted_users=new Talkio.Views.MutedUsers({collection:this.collection}).render(),Talkio.Variables.header=new Talkio.Views.Header({collection:Talkio.Variables.owners}).render(),Talkio.Variables.aside=new Talkio.Views.Aside({collection:this.collection}).render(),Talkio.Variables.footer=new Talkio.Views.Footer({model:Talkio.Variables.current_user}).render(),Talkio.Variables.live=new Talkio.Views.Messages({el:"#live",collection:Talkio.Variables.messages}),Talkio.Variables.connectionIndicator=(new Talkio.Views.ConnectionIndicator).render(),
Talkio.Variables.$window=$(window),Talkio.Variables.$document=$(document),Talkio.Variables.$header=$("header"),Talkio.Variables.$footer=$("footer"),Talkio.Variables.$aside=$("aside"),this.$load_messages_button=$("#load-button"),this.$scroll_down_arrow=$("#scroll_down"),this.$message_input=$("#message_body"),Talkio.Variables.messages.on("add",this.notifyUser,this),Talkio.Variables.owners.on("add",this.changeBodyClass,this),Talkio.Variables.owners.on("remove",this.changeBodyClass,this),Talkio.Variables.$window.on("blur",_.bind(this.onWindowBlur,this)).on("focus",_.bind(this.onWindowFocus,this)).on("scroll",_.bind(this.onWindowScroll,this)).on("beforeunload",_.bind(this.onWindowBeforeUnload,this)),Talkio.Variables.live.on("rendered",this.onWindowFocus,this),this.changeBodyClass(),this.readInactivityTimestamp(),this.removeExpiredMessages(),Talkio.Variables.messages.fetch({reset:!0}),Talkio.Variables.socket=new Socket,Talkio.Variables.current_user.isSignedIn()||!this.is_iframe?setTimeout(_.bind(Talkio.Variables.socket.connect,Talkio.Variables.socket),2e3):Talkio.Variables.socket.connectAJAX(),this.requiresExplicitCookieAccess()?(console.log("Requires explicit Storage access"),this.checkCookieAccess()):(console.log("Has Storage access"),this.has_cookie_access=!0)},hasOnwer:function(){return Talkio.Variables.owners.length>0},removeExpiredMessages:function(){var t=Talkio.Variables.channel_settings.historyTTL();if(_.isNumber(t)){var e=Talkio.Variables.messages.nonExpired();_.each(e,function(e){e.hasExpired(t)&&e.markAsExpired()}),setTimeout(_.bind(this.removeExpiredMessages,this),5e3)}},changeBodyClass:function(){this.$el.removeClass("isHero isTroll isVirgin"),Talkio.Variables.current_user.isSignedIn()?this.$el.addClass(Talkio.Variables.current_user.isAnonymous()?"isHero":"isTroll"):this.$el.addClass("isVirgin"),this.hasOnwer()>0?this.$el.addClass("hasOwner"):this.$el.removeClass("hasOwner")},togglePanel:function(){$("body").toggleClass("showPanel")},softScrollToBottom:function(){this.view_at_the_bottom?this.scrollToBottom():this.$scroll_down_arrow.addClass("new")},scrollToBottom:function(t){typeof t!=undefined&&this.$scroll_down_arrow.removeClass("show"),Talkio.Variables.$window.scrollTop(Talkio.Variables.$document.height())},updateWindowTitle:function(){Tinycon.setBubble(this.inactive_messages)},playSound:function(){if(Talkio.Variables.user_settings.isSoundEnabled())try{this.sound.play()}catch(t){}},showNotification:function(t){Talkio.Variables.user_settings.areNotificationsEnabled()&&this.displayNotification(t.plainBody(),"from "+t.get("nickname"))},displayNotification:function(t,e){var i=notify.createNotification(t,{icon:"/images/logo.png",body:e});setTimeout(function(){i.close()},3e3)},notifyUser:function(t){var e=Talkio.Variables.users.get(t.get("user_token"));_.isObject(e)&&this.window_is_inactive&&!e.isMuted()&&(this.inactive_messages+=1,this.updateWindowTitle(),this.playSound(),this.showNotification(t))},onWindowBlur:function(){this.window_is_inactive=!0,this.saveInactivityTimestamp(),clearTimeout(this.remove_unread_timeout)},onWindowFocus:function(){this.window_is_inactive=!1,this.inactive_messages=0,this.updateWindowTitle(),!this.view_at_the_bottom||this.is_iframe||Modernizr.touchevents||this.$message_input.focus(),this.resetInactivityTimestamp(),this.remove_unread_timeout=setTimeout(function(){$("#chat dd.unread").removeClass("unread")},4e3)},onWindowBeforeUnload:function(){this.saveInactivityTimestamp()},onWindowScroll:function(){clearTimeout(this.scroll_timeout),this.scroll_timeout=setTimeout(_.bind(function(){Talkio.Variables.$window.scrollTop()+120>=Talkio.Variables.$document.height()-Talkio.Variables.$window.height()?(this.$scroll_down_arrow.removeClass("show").removeClass("new"),this.view_at_the_bottom=!0):(this.$scroll_down_arrow.addClass("show"),this.view_at_the_bottom=!1),Talkio.Variables.$window.scrollTop()+10>=Talkio.Variables.$document.height()-Talkio.Variables.$window.height()?$("html").removeClass("isAtBottom"):$("html").addClass("isAtBottom")},this),200)},authWith:function(t){var e="/auth/"+t+"?origin="+encodeURIComponent("/"+Talkio.Variables.permalink);this.is_iframe?this.openPopupWindow(e,"Login with "+t,600,500):window.location.href=e},openPopupWindow:function(t,e,i,n){window.open(t,e,"width="+i+", height="+n+", modal=no, resizable=no, toolbar=no, menubar=no, scrollbars=no, alwaysRaise=yes")},getInactivityTimestamp:function(){return this.inactive_since},readInactivityTimestamp:function(){Cookies.get("inactive_since")&&(this.inactive_since=parseInt(Cookies.get("inactive_since"),10))},saveInactivityTimestamp:function(){this.inactive_since=Math.round((new Date).getTime()/1e3),Cookies.set("inactive_since",this.inactive_since,{path:window.location.pathname})},resetInactivityTimestamp:function(){this.inactive_since=null,Cookies.remove("inactive_since",{path:window.location.pathname})},requiresExplicitCookieAccess:function(){return this.is_iframe&&document.hasStorageAccess&&document.requestStorageAccess},checkCookieAccess:function(){document.hasStorageAccess().then(_.bind(function(t){this.has_cookie_access=t,t?console.log("Storage access is available"):console.log("Storage access is not immediately available")},this),function(t){console.log("Storage access check failed:",t)})},requestCookieAccess:function(t){this.has_cookie_access?(console.log("Storage access is already available"),t()):(console.log("Requesting Storage access"),document.requestStorageAccess().then(_.bind(function(){this.has_cookie_access=!0,console.log("Storage access granted"),t()},this),function(){console.error("Storage access denied")}))}}),Talkio.Views.ConnectionIndicator=Backbone.View.extend({el:"span.header-status",_timer:null,_status:null,_statuses:{progress:"Connecting",online:"Online",error:"Disconnected",hidden:"Online"},render:function(){return this.setStatus("progress"),this},setStatus:function(t){this._status!=t&&(this._timer&&clearTimeout(this._timer),this.$el.removeClass("is-hidden").removeClass(this.statusClass()),this._status=t,this.$el.addClass(this.statusClass()).attr("title",this.statusTitle()),"online"==this._status&&(this._timer=setTimeout(_.bind(this.hide,this),5e3)))},hide:function(){this.$el.removeClass(this.statusClass()).addClass("is-hidden")},statusClass:function(){return"is-"+this._status},statusTitle:function(){return this._statuses[this._status]}}),Talkio.Views.Footer=Backbone.View.extend({el:"footer",events:{"submit #participant-form":"submitParticipantForm","submit #new_message":"submitMessage","click #twitter-button":"joinWithTwitter","click #fb-button":"joinWithFacebook","click #join-toggleButton":"toggleJoin","keydown #message_body":"messageKeydown","keyup #message_body":"messageKeyup","focus #message_body":"messageFocus","blur  #message_body":"messageBlur"},message_body_overflow:0,scroll_height_padding:0,$message_body:null,$footer_avatar:null,$submit_button:null,initialize:function(){this.model.on("currentUserChanged",this.render,this)},render:function(){return this.model.isSignedIn()?(this.model.on("change:nickname",this.changePlaceholder,this),this.$el.html(Talkio.Templates.message_form(this.model.attributes)),this.$message_body=this.$("#message_body"),this.$footer_avatar=this.$("#footer-avatar"),this.$submit_button=this.$("#submit-button"),this.changePlaceholder(),this.$message_body[0].scrollHeight<50&&(this.scroll_height_padding=22)):this.$el.html(Talkio.Templates.join_chatroom({options:Talkio.Variables.channel_settings.attributes})),this},changePlaceholder:function(){this.$message_body.attr("placeholder",this.model.placeholder())},toggleJoin:function(t){t.preventDefault(),this.$("#join-toggleButton").css({display:"none"}),this.$("#join").css({display:"block"}),Talkio.Variables.chat_room.scrollToBottom()},submitParticipantForm:function(t){t.preventDefault(),Talkio.Variables.chat_room.requestCookieAccess(_.bind(this.joinAsTroll,this))},joinAsTroll:function(){var t=this.$("#participant_nickname").val().trim();console.log("Joining participant \u2014 ",t),t.length&&this.model.save({nickname:t},{wait:!0,error:_.bind(function(t,e){"vpn_restricted"==e.responseJSON.error&&(alert("Nickname logins are disabled for VPN users"),Talkio.Variables.channel_settings.set("allow_anonymous",!1),this.render())},this)})},joinWithTwitter:function(t){t.preventDefault(),Talkio.Variables.chat_room.authWith("twitter")},joinWithFacebook:function(t){t.preventDefault(),Talkio.Variables.chat_room.authWith("facebook")},messageKeydown:function(t){this.$message_body.val().length;if(13==t.keyCode&&!t.shiftKey)return t.preventDefault(),this.submitMessage(),!1},messageKeyup:function(t){var e;if(13!=t.keyCode||t.shiftKey){var i=this.$message_body.val(),n=i.length;n>10?this.model.setTyping():0==n&&this.model.setCancelledTyping();var s=this.$message_body[0].scrollHeight-50;s!=this.message_body_overflow&&(this.$message_body[0].style.height="auto",s=this.$message_body[0].scrollHeight-50,this.message_body_overflow=s,this.$message_body.css({height:50+this.message_body_overflow+this.scroll_height_padding+"px"}),Talkio.Variables.chat_room.scrollToBottom()),e="rotate("+n+"deg)"}else e="rotate(0deg)";this.$footer_avatar.css({transform:e})},messageFocus:function(){this.$el.addClass("hasFocus"),this.$submit_button&&this.$submit_button.removeClass("show"),Modernizr.touchevents&&(Talkio.Variables.$aside.addClass("removed"),Talkio.Variables.$header.addClass("removed"))},messageBlur:function(){this.$el.removeClass("hasFocus"),this.$message_body.val().length>0&&this.$submit_button.addClass("show"),Modernizr.touchevents&&(Talkio.Variables.$aside.removeClass("removed"),Talkio.Variables.$header.removeClass("removed"),Talkio.Variables.chat_room.scrollToBottom())},replyToUsername:function(t){if(t&&this.$message_body){var e=this.$message_body.val();if(t.match(/^[a-zA-Z0-9_\-]+$/))var i="@"+t+" ";else var i="@/"+t+"/ ";e.length>0&&" "!=e[e.length-1]&&this.$message_body.val(e+" "),this.$message_body.val(this.$message_body.val()+i).focus(),this.$message_body[0].selectionStart=this.$message_body[0].selectionEnd=this.$message_body.val().length,Talkio.Variables.chat_room.scrollToBottom()}},submitMessage:function(t){(t&&t.preventDefault(),this.$message_body.val().length>0)&&(new Talkio.Models.Message({body:this.$message_body.val()}).save({},{success:function(){window.ga("send","event","message","sent")}}),this.model._typing=!1,this.$submit_button.removeClass("show"),this.$message_body.val("").attr({style:""}),this.message_body_overflow=0,this.$footer_avatar.css({transform:"rotate(0deg)"}))}}),Talkio.Views.Header=Backbone.View.extend({el:"#header",$logo:null,initialize:function(){this.$logo=this.$("a.header-avatar"),this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this)},render:function(){if(this.collection.length>0){var t=this.collection.first();this.$logo.css("backgroundImage","url("+t.biggerAvatar()+")").attr("href",t.get("profile_url")).attr("target","_blank")}else this.$logo.css("backgroundImage","").attr("href","http://tlk.io").removeAttr("target");return this}}),Talkio.Views.Messages=Backbone.View.extend({events:{"click #load-button":"loadEarlierMessages"},silent:!1,initialize:function(t){t.silent&&(this.silent=t.silent),this.collection.on("reset",this.render,this),this.collection.on("add",this.renderMessage,this),this.collection.on("earlier_messages_loaded",this.renderEarlierMessages,this),this.collection.on("messages_deleted",this.markDeletedMessages,this),this.current_message_container=null,this.current_timestamp=0,this.timestamp_format="",this.traling_timestamp=!1,this.$load_button=this.$("#load-button")},setNewMessageContainer:function(t){this.current_message_container=new Talkio.Views.MessagesContainer({author:t}),this.$el.append(this.current_message_container.render().el),this.traling_timestamp=!1},render:function(){return this.collection.size()>0?(this.current_timestamp=this.collection.first().get("closest_milestone"),this.collection.each(this.renderMessage,this),this.renderCurrentTimestamp(),this.collection.size()>=Talkio.Variables.message_view_limit&&this.$load_button.addClass("show"),this.silent||Talkio.Variables.chat_room.scrollToBottom()):(this.$el.empty(),this.$load_button.removeClass("show"),this.current_message_container=null),Talkio.Variables.chat_room.resetInactivityTimestamp(),this.trigger("rendered"),this},renderMessage:function(t){this.current_message_container?this.current_timestamp!=t.get("closest_milestone")?(this.renderCurrentTimestamp(),this.current_timestamp=t.get("closest_milestone"),this.setNewMessageContainer(t.author())):this.current_message_container&&!this.current_message_container.isCurrentAuthor(t.author())&&this.setNewMessageContainer(t.author()):this.setNewMessageContainer(t.author()),this.current_message_container.renderMessage(t)},renderCurrentTimestamp:function(){this.current_message_container.$el.addClass("last-of-time"),!this.traling_timestamp&&this.current_timestamp>0&&(this.$el.append($('<time class="time" />').html(Talkio.Variables.timestamps[this.current_timestamp])),this.traling_timestamp=!0)},renderEarlierMessages:function(t){if(t.count>0){var e=new Talkio.Collections.Messages(this.collection.first(t.count)),i=new Talkio.Views.Messages({collection:e,silent:!0}),n=this.$("dl:first"),s=n.position().top-Talkio.Variables.$window.scrollTop();this.$load_button.after(i.render().$el),Talkio.Variables.$window.scrollTop(n.position().top-s)}this.$load_button.removeClass("isLoading"),t.count<Talkio.Variables.message_view_limit&&this.$load_button.removeClass("show"),delete e,delete i},loadEarlierMessages:function(){this.$load_button.addClass("isLoading"),this.collection.loadEarlierMessages()},markDeletedMessages:function(t){$("#chat dl.author_"+t).addClass("deleted")}}),Talkio.Views.MessagesContainer=Backbone.View.extend({tagName:"dl",events:{"click  .js-reply":"reply"},author:null,initialize:function(t){this.author=t.author},isCurrentAuthor:function(t){return this.author&&this.author.id==t.id},hasMessages:function(){return this.messages.length>0},render:function(){return this.author&&(this.$el.addClass("post author_"+this.author.id).attr("data-user-id",this.author.id).attr("data-user-nickname",this.author.nickname),Talkio.Variables.users.isCurrentUser(this.author.id)&&this.$el.addClass("me"),this.renderAuthor()),this},renderMessage:function(t){this.$el.append(new Talkio.Views.Message({model:t}).render().el)},renderAuthor:function(){this.$el.append(Talkio.Templates.message_author(this.author))},reply:function(t){t.preventDefault(),Talkio.Variables.footer.replyToUsername(this.author.nickname)}}),Talkio.Views.Message=Backbone.View.extend({template:Talkio.Templates.message,tagName:"dd",events:{"click      a.reply":"reply","click      img":"toggleImage","mouseenter .post-time":"showTimestamp","click      .post-time-dot":"showTimestamp","click      .js-post-time-tag":"toggleTimestamp","click      #delete-message":"deleteMessage"},timestamp_format:null,$delete_button:null,initialize:function(){Talkio.Variables.current_user.on("ownership_changed",this.configureOwner,this),this.model.on("change:deleted",this.markAsDeleted,this),this.model.on("change:expired",this.markAsExpired,this)},reply:function(t){t.preventDefault(),Talkio.Variables.footer.replyToUsername($(t.target).data("reply-to"))},toggleImage:function(t){$(t.target).toggleClass("expanded")},markAsDeleted:function(){this.model.isDeleted()&&this.$el.addClass("deleted").html(this.model.get("body"))},markAsExpired:function(){this.$el.addClass("expired")},configureOwner:function(){this.model.canBeDeletedBy(Talkio.Variables.current_user)?this.$delete_button.show():this.$delete_button.hide()},showTimestamp:function(){this.$(".js-post-time-tag").text($.timeago(this.model.createdAt())),this.timestamp_format="relative"},toggleTimestamp:function(){"relative"==this.timestamp_format?(this.$(".js-post-time-tag").text(this.model.createdAt().toLocaleString()),this.timestamp_format="absolute"):this.showTimestamp()},deleteMessage:function(){this.model.canBeDeletedBy(Talkio.Variables.current_user)&&this.model["delete"]()},render:function(){var t=this.model.processedBody();if(Talkio.Variables.current_user.isSignedIn()){var e=new RegExp(">@"+Talkio.Variables.current_user.get("nickname")+"<","i");t.match(e)&&this.$el.addClass("is-reply")}return this.$el.addClass("post-message").attr("data-timestamp",this.model.get("timestamp")).html(this.template({body:t})),this.$('a[data-type="image"]').each(_.bind(function(t,e){this.$el.prepend('<img class="post-img" src="'+$(e).attr("href")+'" />')},this)),this.model.justAdded()&&!Talkio.Variables.chat_room.window_is_inactive&&this.$el.addClass("animate"),this.model.isReadByCurrentUser()||this.$el.addClass("unread"),this.$delete_button=this.$("#delete-message"),this.configureOwner(),this.markAsDeleted(),this}}),Talkio.Views.OnlineUsers=Backbone.View.extend({el:"#online-participants",initialize:function(){this.collection.on("add",this.renderUser,this),this.collection.on("remove",this.checkUserAmount,this),this.collection.on("set_offline",this.setAllUsersOffline,this),this.collection.on("change:banned",this.toggleUser,this)},render:function(){return this.$el.html(""),this.collection.each(this.renderUser,this),this},renderUser:function(t){this.$el.append(new Talkio.Views.OnlineUser({model:t}).render().el),this.checkUserAmount()},checkUserAmount:function(){var t=this.$el.parents("aside");this.collection.length>0?t.removeClass("hasZeroParticipants"):t.addClass("hasZeroParticipants")},setAllUsersOffline:function(){this.$("li").addClass("offline")},toggleUser:function(t){t.isBanned()?this.$("#author_"+t.id).remove():this.renderUser(t)}}),Talkio.Views.OnlineUser=Backbone.View.extend({tagName:"li",events:{click:"toggleUserMute"},initialize:function(){this.model.on("remove",this.remove,this),this.model.on("new_message",this.moveToTop,this),this.model.on("change:nickname",this.rename,this),this.model.on("change:is_typing",this.setTyping,this)},toggleUserMute:function(){Talkio.Variables.users.isCurrentUser(this.model.id)||(this.$el.toggleClass("muted"),this.model.isMuted()?(Talkio.Variables.muted_user_ids=_.without(Talkio.Variables.muted_user_ids,this.model.id),this.model.trigger("removeMutedUser",this)):(Talkio.Variables.muted_user_ids.push(this.model.id),this.model.trigger("addMutedUser",this)),Cookies.set("ban_list",Talkio.Variables.muted_user_ids.join(","),{expires:7,path:window.location.pathname}),Talkio.Variables.chat_room.scrollToBottom())},moveToTop:function(){this.$el.removeClass("updated").detach().removeClass("typing").prependTo("#online-participants").addClass("updated")},setTyping:function(){this.model.isTyping()?this.$el.addClass("typing"):this.$el.removeClass("typing")},rename:function(t){this.$el.html(t.get("nickname"))},render:function(){return this.$el.attr("id","author_"+this.model.id).addClass("list-item").html(Talkio.Templates.online_user(this.model.attributes)),this.model.isMuted()&&this.$el.addClass("muted"),this}}),Talkio.Views.UserCounter=Backbone.View.extend({counter_elements:[],_guests_count:0,_users_count:0,initialize:function(t){this.counter_elements=t.elements,this.collection.on("add",this.updateCount,this),this.collection.on("remove",this.updateCount,this),this.collection.on("change:banned",this.updateCount,this)},updateCount:function(t){_.isNumber(t)&&(this._guests_count=t),this._users_count=this.collection.length-this.collection.banned().length,this.render()},increaseGuestsCount:function(){this._guests_count+=1,this.render()},decreaseGuestsCount:function(){this._guests_count-=1,this.render()},currentCount:function(){return this._users_count},render:function(){return _.each(this.counter_elements,function(t){$(t).text(this.currentCount())},this),this}}),Talkio.Views.UserSettings=Talkio.Classes.AsidePanel.extend({el:"#user-settings",events:{"click #mute_button":"toggleMute","click #notifications":"toggleNotifications","click #theme-picker li":"changeTheme","click #sign-out":"signOut"},$mute_button:null,$notifications_button:null,$sign_out_button:null,_owned_channels_list:null,initialize:function(){this._owned_channels_list=new Talkio.Views.OwnedChannelsList({collection:Talkio.Variables.owned_channels}),this.$mute_button=this.$("#mute_button"),this.$notifications_button=this.$("#notifications"),this.$sign_out_button=this.$("#sign-out"),this.model.on("change:sound_enabled",this.renderMuteButton,this),this.model.on("change:notifications_enabled",this.renderNotificationsButton,this),this.model.on("change:current_theme",this.renderTheme,this),Talkio.Variables.current_user.on("currentUserChanged",this.renderSignOutButton,this)},render:function(){return this.renderMuteButton(),this.renderNotificationsButton(),this.renderTheme(),this.renderSignOutButton(),this._owned_channels_list.render(),this},renderMuteButton:function(){this.model.isSoundEnabled()?this.$mute_button.addClass("isOn"):this.$mute_button.removeClass("isOn")},renderNotificationsButton:function(){this.model.areNotificationsSupported()?this.model.areNotificationsEnabled()?this.$notifications_button.addClass("isOn"):this.$notifications_button.removeClass("isOn"):this.$notifications_button.hide()},renderTheme:function(){this.$("#theme-picker .isSelected").removeClass("isSelected"),this.$("#theme-picker li[data-theme="+this.model.get("current_theme")+"]").addClass("isSelected"),$("html").removeClass(this.model.get("previous_theme")).addClass(this.model.get("current_theme"))},renderSignOutButton:function(){Talkio.Variables.current_user.isSignedIn()?this.$sign_out_button.show():this.$sign_out_button.hide()},toggleMute:function(t){t.preventDefault(),this.model.toggleSound()},toggleNotifications:function(t){t.preventDefault(),this.model.toggleNotifications()},changeTheme:function(t){t.preventDefault(),this.model.setTheme(this.$(t.currentTarget).data("theme"))},signOut:function(t){t.preventDefault(),$.post(Talkio.Paths.sign_out,_.bind(function(){Talkio.Variables.current_user.signOut(),this.hide()},this),"json"),this.$("#user-settings").removeClass("show")}}),Talkio.Views.OwnedChannelsList=Backbone.View.extend({el:"#owned-channel-list",$list:null,initialize:function(){this.collection.on("add",this.render,this),this.collection.on("remove",this.render,this),this.$list=this.$("ul")},render:function(){return this.$("ul").html(""),Talkio.Variables.owned_channels.length>0?(Talkio.Variables.owned_channels.each(function(t){this.$list.append(Talkio.Templates.owned_channel(t.attributes))},this),this.$el.show()):this.$el.hide(),this}}),Talkio.Views.Widgets.DailyMessages=Backbone.View.extend({el:"#daily-messages",chart:null,hoverDetail:null,render:function(){if(!this.chart){var t=[];_.each(this.model.get("daily_messages"),function(e,i){t.push({x:i,y:e})}),this.chart=new Rickshaw.Graph({element:this.$(".chart").get(0),renderer:"area",stroke:!0,padding:{top:.05},series:[{color:"#eee",data:t}]}),this.chart.render()}return this}}),Talkio.Views.Widgets.MessageRate=Backbone.View.extend({el:"#message-rate",chart:null,hoverDetail:null,initialize:function(){this.model.on("change:messages_per_last_minute",this.render,this)},render:function(){if(!this.chart){var t=[];_.each(this.model.get("minutely_messages"),function(e,i){t.push({x:i,y:e})}),this.chart=new Rickshaw.Graph({element:this.$(".chart").get(0),renderer:"area",stroke:!0,padding:{top:.05},series:[{color:"#eee",data:t,name:"Messages"}]}),this.chart.render()}return this.$("em").text(this.model.get("messages_per_last_minute")),this}}),Talkio.Views.Widgets.OnlineUsers=Backbone.View.extend({el:"#online-users",chart:null,initialize:function(){this.model.on("change:twitter_user_count",this.render,this),this.model.on("change:non_twitter_user_count",this.render,this),this.model.on("change:total_user_count",this.render,this)},render:function(){var t=this.$("canvas").get(0).getContext("2d");return this.chart=new Chart(t).Pie([{value:this.model.get("twitter_user_count"),color:"#ddd"},{value:this.model.get("non_twitter_user_count"),color:"#fff"},{value:this.model.guestsCount(),color:"#bbb"}],{animationEasing:"easeOutQuad",animation:!1}),this.$(".total-users").text(this.model.get("total_user_count")),this.$(".twitter").text(this.model.get("twitter_user_count")),this.$(".non-twitter").text(this.model.get("non_twitter_user_count")),this.$(".guests").text(this.model.guestsCount()),this}}),Talkio.Views.Widgets.TotalChatrooms=Backbone.View.extend({el:"#total-chatrooms",chart:null,data:[],last_index:0,records_to_keep:20,initialize:function(){},grabNewData:function(){this.data.push({x:this.last_index,y:this.model.get("non_empty_room_count")}),this.last_index+=1,this.data.length>this.records_to_keep&&this.data.splice(0,this.data.length-this.records_to_keep)},render:function(){return this.grabNewData(),this.chart?this.chart.update():(this.chart=new Rickshaw.Graph({element:this.$(".chart").get(0),renderer:"area",interpolation:"linear",stroke:!0,padding:{top:.05},series:[{color:"#eee",data:this.data}]}),this.chart.render()),this.$("em").text(this.model.get("non_empty_room_count")),this}}),Talkio.Views.Widgets.TotalUsers=Backbone.View.extend({el:"#total-users",chart:null,render:function(){if(!this.chart){var t=[];_.each(this.model.get("total_users"),function(e,i){t.push({x:i,y:e})}),this.chart=new Rickshaw.Graph({element:this.$(".chart").get(0),renderer:"area",stroke:!0,padding:{top:.05},series:[{color:"#eee",data:t}]}),this.chart.render()}return this}});var Authenticator={outgoing:function(t,e){Talkio.Variables.current_user.isSignedIn()&&(t.ext||(t.ext={}),t.ext.token=Talkio.Variables.current_user.id),e(t)}},Socket=function(){this.initialize.apply(this,arguments)};_.extend(Socket.prototype,{_faye_client:null,_socket_notifications:null,_private_subscription:null,_public_subscription:null,_AJAX_timer:null,_ping_timer:null,initialize:function(){this._socket_notifications=new SocketNotifications,this._faye_client=new Faye.Client(Talkio.Variables.faye_server,{timeout:85}),this._faye_client.addExtension(Authenticator),this._faye_client.on("transport:up",_.bind(this._onTransportUp,this)),this._faye_client.on("transport:down",_.bind(this._onTransportDown,this))},connect:function(){clearInterval(this._AJAX_timer),clearTimeout(this._ping_timer),this._public_subscription=this._faye_client.subscribe(this.publicChannel(),_.bind(this.processMessage,this)),this._private_subscription=this._faye_client.subscribe(this.privateChannel(),_.bind(this.processMessage,this))},connectAJAX:function(){this.unsubscribe(),Talkio.Variables.connectionIndicator.setStatus("online"),this._AJAX_timer=setInterval(function(){Talkio.Variables.messages.loadNewMessages()},9e4)},disconnect:function(){this._faye_client.disconnect()},unsubscribe:function(){this._public_subscription&&this._public_subscription.cancel(),this._private_subscription&&this._private_subscription.cancel()},publicChannel:function(){return"/chats/"+Talkio.Variables.chat_id+"/public"},privateChannel:function(t){var e="/chats/"+Talkio.Variables.chat_id+"/private/"+Talkio.Variables.session_token;return _.isString(t)&&(e+="/"+t),e},publishPublicMessage:function(t,e){return this._faye_client.publish(this.publicChannel(),{type:t,data:e})},publishPrivateMessage:function(t,e){return this._faye_client.publish(this.privateChannel(t),e||"")},processMessage:function(t){this._socket_notifications.process(t)},_ping:function(){clearTimeout(this._ping_timer),this.publishPrivateMessage("ping"),this._ping_timer=setTimeout(_.bind(this._ping,this),15e3)},_onTransportUp:function(){this._ping(),Talkio.Variables.aside.setConnected(),Talkio.Variables.connectionIndicator.setStatus("online"),Talkio.Variables.chat_room.is_offline&&(Talkio.Variables.chat_room.is_offline=!1)},_onTransportDown:function(){clearTimeout(this._ping_timer),Talkio.Variables.connectionIndicator.setStatus("error"),Talkio.Variables.chat_room.is_offline=!0,Talkio.Variables.users.trigger("set_offline")}});var SocketNotifications=function(){this.process=function(t){_.isString(t)&&(t=JSON.parse(t)),typeof t!=undefined&&t&&this.execute(t.type,t.data)},this.execute=function(t,e){this[t](e)},this.MESSAGE=function(t){Talkio.Variables.messages.add(_.defaults(t,{just_added:!0})),Talkio.Variables.chat_room.softScrollToBottom();var e=Talkio.Variables.users.get(t.user_token);e&&(e.set("is_typing",!1,{silent:!0}),e.trigger("new_message"),e.isCurrentUser()&&Talkio.Variables.aside.enableRemoveButtons())},this.MESSAGE_DELETED=function(t){Talkio.Variables.messages.markAsDeleted(t.id,t.body)},this.ALL_MESSAGES_DELETED=function(t){Talkio.Variables.messages.markAsDeletedForUser(t.user_token,t.body)},this.CHAT_UPDATED=function(t){Talkio.Variables.channel_settings.set(t.chat)},this.CHAT_DELETED=function(){Talkio.Variables.messages.reset()},this.ONLINE_PARTICIPANTS=function(t){Talkio.Variables.users.reset(),_.each(t.users,function(t){Talkio.Variables.users.addUserWithData(t,{silent:!0})}),Talkio.Variables.online_users.render(),Talkio.Variables.user_counter.updateCount(t.guests)},this.GUEST_JOINED=function(){Talkio.Variables.user_counter.increaseGuestsCount()},this.GUEST_LEFT=function(){Talkio.Variables.user_counter.decreaseGuestsCount()},this.USER_JOINED=function(t){Talkio.Variables.users.addUserWithData(t)},this.USER_LEFT=function(t){Talkio.Variables.users.removeUser(t.token)},this.USER_AUTHENTICATED=function(t){Talkio.Variables.users.addUserWithData(t),Talkio.Variables.user_counter.decreaseGuestsCount()},this.USER_DEAUTHENTICATED=function(t){Talkio.Variables.users.removeUser(t.token),Talkio.Variables.user_counter.increaseGuestsCount()},this.USER_IS_TYPING=function(t){var e=Talkio.Variables.users.get(t.token);e&&e.setTyping()},this.USER_CANCELLED_TYPING=function(t){var e=Talkio.Variables.users.get(t.token);e&&e.setCancelledTyping()},this.USER_BECAME_OWNER=function(t){Talkio.Variables.owners.add(t.user),Talkio.Variables.channel_settings.set(t.chat)},this.USER_RESIGNED_OWNERSHIP=function(t){Talkio.Variables.messages.reset(),Talkio.Variables.owners.remove(t.user.token),Talkio.Variables.channel_settings.set(t.chat),Talkio.Variables.chat_room.removeExpiredMessages()},this.USER_BANNED=function(t){Talkio.Variables.users.get(t.user.token).ban()},this.USER_UNBANNED=function(t){Talkio.Variables.users.get(t.user.token).unban()},this.PING=function(){}};$(function(){new FastClick($("body")[0]),window!=window.top&&$("html").addClass("isIframe"),window.bugsnagClient=bugsnag("7f65fd578f2344d2fb6833d990b037e3")});